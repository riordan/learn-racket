<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>VI&nbsp;Accumulators</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="shared.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="figure.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="figure.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">How to Design Programs, Second Edition</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="part_prologue.html" class="tocviewlink" data-pltdoc="x">Prologue:<span class="mywbr"> &nbsp;</span> How to Program</a></td></tr><tr><td align="right">I&nbsp;</td><td><a href="part_one.html" class="tocviewlink" data-pltdoc="x">Fixed-<wbr></wbr>Size Data</a></td></tr><tr><td align="right"></td><td><a href="i1-2.html" class="tocviewlink" data-pltdoc="x">Intermezzo:<span class="mywbr"> &nbsp;</span> BSL</a></td></tr><tr><td align="right">II&nbsp;</td><td><a href="part_two.html" class="tocviewlink" data-pltdoc="x">Arbitrarily Large Data</a></td></tr><tr><td align="right"></td><td><a href="i2-3.html" class="tocviewlink" data-pltdoc="x">Intermezzo:<span class="mywbr"> &nbsp;</span> Quote, Unquote</a></td></tr><tr><td align="right">III&nbsp;</td><td><a href="part_three.html" class="tocviewlink" data-pltdoc="x">Abstraction</a></td></tr><tr><td align="right"></td><td><a href="i3-4.html" class="tocviewlink" data-pltdoc="x">Intermezzo:<span class="mywbr"> &nbsp;</span> Scope</a></td></tr><tr><td align="right">IV&nbsp;</td><td><a href="part_4.html" class="tocviewlink" data-pltdoc="x">Intertwined Data</a></td></tr><tr><td align="right"></td><td><a href="i4-5.html" class="tocviewlink" data-pltdoc="x">Intermezzo:<span class="mywbr"> &nbsp;</span> Pattern Matching</a></td></tr><tr><td align="right">V&nbsp;</td><td><a href="part_five.html" class="tocviewlink" data-pltdoc="x">Generative Recursion</a></td></tr><tr><td align="right"></td><td><a href="i5-6.html" class="tocviewlink" data-pltdoc="x">Intermezzo:<span class="mywbr"> &nbsp;</span> Vectors</a></td></tr><tr><td align="right">VI&nbsp;</td><td><a href="part_six.html" class="tocviewselflink" data-pltdoc="x">Accumulators</a></td></tr><tr><td align="right"></td><td><a href="htdp2e-epilogue.html" class="tocviewlink" data-pltdoc="x">Epilogue</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>VI&nbsp;</td><td><a href="part_six.html" class="tocviewselflink" data-pltdoc="x">Accumulators</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">36&nbsp;</td><td><a href="part_six.html#%28part._ch~3aaccumulator-samples%29" class="tocviewlink" data-pltdoc="x">The Loss of Knowledge</a></td></tr><tr><td align="right">37&nbsp;</td><td><a href="part_six.html#%28part._sec~3adesign-accu%29" class="tocviewlink" data-pltdoc="x">Designing Accumulator-<wbr></wbr>Style Functions</a></td></tr><tr><td align="right">38&nbsp;</td><td><a href="part_six.html#%28part._ch~3amore-accu%29" class="tocviewlink" data-pltdoc="x">More Uses of Accumulation</a></td></tr><tr><td align="right">39&nbsp;</td><td><a href="part_six.html#%28part._ch~3asummary6%29" class="tocviewlink" data-pltdoc="x">Summary</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">36<tt>&nbsp;</tt></span><a href="part_six.html#%28part._ch~3aaccumulator-samples%29" class="tocsubseclink" data-pltdoc="x">The Loss of Knowledge</a></td></tr><tr><td><span class="tocsublinknumber">36.1<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3aloss~3astructural%29" class="tocsubseclink" data-pltdoc="x">A Problem with Structural Processing</a></td></tr><tr><td><span class="tocsublinknumber">36.2<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3aloss~3agenerative%29" class="tocsubseclink" data-pltdoc="x">A Problem with Generative Recursion</a></td></tr><tr><td><span class="tocsublinknumber">37<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3adesign-accu%29" class="tocsubseclink" data-pltdoc="x">Designing Accumulator-<wbr></wbr>Style Functions</a></td></tr><tr><td><span class="tocsublinknumber">37.1<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3aneed-accu%29" class="tocsubseclink" data-pltdoc="x">Recognizing the Need for an Accumulator</a></td></tr><tr><td><span class="tocsublinknumber">37.2<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3aaccu-style%29" class="tocsubseclink" data-pltdoc="x">Adding Accumulators</a></td></tr><tr><td><span class="tocsublinknumber">37.3<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3atrans-accu%29" class="tocsubseclink" data-pltdoc="x">Transforming Functions into Accumulator-<wbr></wbr>Style</a></td></tr><tr><td><span class="tocsublinknumber">37.4<tt>&nbsp;</tt></span><a href="part_six.html#%28part._accu-edit._sec~3aedit3%29" class="tocsubseclink" data-pltdoc="x">A Graphical Editor, with Mouse</a></td></tr><tr><td><span class="tocsublinknumber">38<tt>&nbsp;</tt></span><a href="part_six.html#%28part._ch~3amore-accu%29" class="tocsubseclink" data-pltdoc="x">More Uses of Accumulation</a></td></tr><tr><td><span class="tocsublinknumber">38.1<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3amore-accu-trees%29" class="tocsubseclink" data-pltdoc="x">Accumulators and Trees</a></td></tr><tr><td><span class="tocsublinknumber">38.2<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3amore-accu-mc%29" class="tocsubseclink" data-pltdoc="x">Data Representations with Accumulators</a></td></tr><tr><td><span class="tocsublinknumber">38.3<tt>&nbsp;</tt></span><a href="part_six.html#%28part._sec~3afractal-acc%29" class="tocsubseclink" data-pltdoc="x">Accumulators as Results</a></td></tr><tr><td><span class="tocsublinknumber">39<tt>&nbsp;</tt></span><a href="part_six.html#%28part._ch~3asummary6%29" class="tocsubseclink" data-pltdoc="x">Summary</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.1.1.8</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="i5-6.html" title="backward to &quot;Intermezzo: Vectors&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;How to Design Programs, Second Edition&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="htdp2e-epilogue.html" title="forward to &quot;Epilogue&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>VI<tt>&nbsp;</tt><a name="(part._part~3asix)"></a>Accumulators</h3><p>When you ask ISL+ to apply some function <span class="RktSym">f</span> to an argument
 <span class="RktSym">a</span>, you usually get some value <span class="RktSym">v</span>. If you evaluate
 <span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span> again, you get <span class="RktSym">v</span> again.<span class="refelem"><span class="refcolumn"><span class="refcontent">The function
application may also loop forever or signal an error, but let&rsquo;s ignore
these possibilities for now. We also ignore <span class="RktSym">random</span>, which is the
only real exception to this rule.</span></span></span> As a matter of fact, you get the same
 result no matter how often you request the evaluation of <span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span>.
 Whether the function is applied for the first time or the hundredth time,
 whether the application is located in DrRacket&rsquo;s interactions area or inside
 the function itself, doesn&rsquo;t matter. The function works according to its
 purpose statement, and that&rsquo;s all you need to know.</p><p>This principle of context-independence plays a critical role in the design
 of recursive functions. When it comes to coding, you are free to assume
 that the function computes what the purpose statement promises&#8212;<wbr></wbr>even if
 the function isn&rsquo;t defined yet. In particular, you are free to use the
 results of recursive calls to create the code of some function, usually
 one of its <span class="RktSym">cond</span> clauses. The template and coding steps of the
 design recipes for both structurally and generative recursive functions
 rely on this idea.</p><p>Although context-independence facilitates the design of functions, it also
 causes two problems.  The general idea is that context-independence
 induces a loss of knowledge during a recursive evaluation; a function does
 not &ldquo;know&rdquo; whether it is called on a complete list or on a piece of that
 list.  For structurally recursive programs this loss of knowledge means
 that they may have to traverse data more than once, inducing a grave
 performance cost. For functions that employ generative recursion, the loss
 means that the function may not be able to compute the result; instead the
 function loops forever for certain inputs. The preceding part illustrates
 this second problem with a graph traversal function that cannot find a
 path between two nodes for a circular graph.</p><p>This part introduces a variant of the design recipes to address this &ldquo;loss
 of context&rdquo; problem. Since we wish to retain the principle that
 <span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span> returns the same result no matter how often it is
 evaluated, our only solution is to add <span style="font-weight: bold">an argument that represents
the context</span> of the function call. We call this additional argument an
 <span style="font-style: italic">accumulator</span>. During the traversal of data, the recursive calls
 continue to receive new regular arguments while accumulators change in
 relation to the other arguments and the context of the call.</p><p>Designing functions with accumulators correctly is clearly more complex
 than any of the design approaches from the preceding chapters. The key is
 to understand the relationship between the proper arguments and the
 accumulators. The following chapters explain how to design functions with
 accumulators and how they work.</p><h3>36<tt>&nbsp;</tt><a name="(part._ch~3aaccumulator-samples)"></a>The Loss of Knowledge</h3><p>Both functions designed according to structural recipes and the generative
one suffer from the loss of knowledge, though in different ways. This
chapter explains with two examples&#8212;<wbr></wbr>one from each category&#8212;<wbr></wbr>how the lack
of contextual knowledge affects the performance of functions. While the
first section is about structural recursion, the second one addresses
concerns in the generative realm.</p><h4>36.1<tt>&nbsp;</tt><a name="(part._sec~3aloss~3astructural)"></a>A Problem with Structural Processing</h4><p>Let&rsquo;s start with a seemingly straightforward example:</p><blockquote><p><span style="font-weight: bold">Sample Problem: </span>You are working for a geometer team that will measure the length
of roads segments. The team asked you to design a program that translates these
relative distances between a series of road points into absolute distances for
some starting point.</p></blockquote><p><div class="SIntrapara">For example, we might be given a line such as this:
</div><div class="SIntrapara"><blockquote><p><img src="pict_465.png" alt="image" width="300" height="50"/></p></blockquote></div><div class="SIntrapara">Each number specifies the distance between two dots. What we need is the
following picture, where each dot is annotated with the distance to the
left-most end:
</div><div class="SIntrapara"><blockquote><p><img src="pict_466.png" alt="image" width="300" height="50"/></p></blockquote></div></p><p>Designing a program that performs this calculation is at this point an
exercise in structural function design. <a href="part_six.html#%28counter._%28figure._fig~3arel-abs-dist%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">103</span></a>
contains the complete program. When the given list is not <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>,
the natural recursion computes the absolute distance of the remainder of
the dots to the first item on <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="stt"> </span><span class="RktSym">alon</span><span class="RktPn">)</span>. Because the first item
is not the actual origin and has a distance of <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="stt"> </span><span class="RktSym">alon</span><span class="RktPn">)</span> to the
origin, we must add <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="stt"> </span><span class="RktSym">alon</span><span class="RktPn">)</span> to each number on the result of
the natural recursion. This second step&#8212;<wbr></wbr>adding a number to each item on a
list of numbers&#8212;<wbr></wbr>requires an auxiliary function.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">convert a list of relative distances to a list of absolute distances</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the first item on the list represents the distance to the origin</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">70</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">160</span><span class="hspace">&nbsp;</span><span class="RktVal">190</span><span class="hspace">&nbsp;</span><span class="RktVal">220</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rest-of-l</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">adjusted</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-each</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">rest-of-l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">adjusted</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">add </span><span class="RktSym">n</span><span class="RktCmt"> to each number on </span><span class="RktSym">alon</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-each</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">110</span><span class="hspace">&nbsp;</span><span class="RktVal">140</span><span class="hspace">&nbsp;</span><span class="RktVal">170</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">160</span><span class="hspace">&nbsp;</span><span class="RktVal">190</span><span class="hspace">&nbsp;</span><span class="RktVal">220</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-each</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-each</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3arel-abs-dist))" x-target-lift="Figure"></a>Figure&nbsp;103: </span>Converting relative distances to absolute distances</span></p></blockquote><p><div class="SIntrapara">While designing the program is relatively straightforward, using it on larger
and larger lists reveals a problem. Consider the evaluation of the
following expression:<span class="refelem"><span class="refcolumn"><span class="refcontent">Use <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._build-list%29%29" class="RktValLink" data-pltdoc="x">build-list</a></span><span class="stt"> </span><span class="RktSym">size</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span><span class="RktPn">)</span> to
construct these lists.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">size</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">As we increase <span class="RktSym">size</span>, the time needed grows even faster:</div></p><p><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td align="right"><p><span class="RktSym">size</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>2000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>3000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>4000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>6000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>7000</p></td></tr><tr><td align="right"><p>time</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>25</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>109</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>234</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>429</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>689</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>978</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1365</p></td></tr></table></blockquote></div><div class="SIntrapara">Instead of doubling as we go from <span style="font-style: italic"></span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> to <span style="font-style: italic"></span>2<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> items, the
time quadruples. This is also the approximate relationship for going from
<span style="font-style: italic"></span>2<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> to <span style="font-style: italic"></span>4<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>, and so on.<span class="refelem"><span class="refcolumn"><span class="refcontent">The time of evaluation
will differ from computer to computer and from year to year. These
measurements were conducted in 2014 on a MacMini running OS X 10.8.5; the
previous measurement took place in 1998, and the times were <span style="font-style: italic"></span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic">x</span>
larger.</span></span></span></div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3aadd-to-each-map))"></a><span style="font-weight: bold">Exercise</span>&nbsp;401. Reformulate <span class="RktSym">add-to-each</span> using <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span> and
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span>. <img src="pict_467.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3arel-abs-.O))"></a><span style="font-weight: bold">Exercise</span>&nbsp;402. Determine the abstract running time of <span class="RktSym">relative-&gt;absolute</span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">Hint</span> Evaluate the expression
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">size</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">by hand. Start by replacing <span class="RktSym">size</span> with 1, 2, and 3. How many natural
recursions of <span class="RktSym">relative-&gt;absolute</span> and <span class="RktSym">add-to-each</span> are
required each time? <img src="pict_468.png" alt="image" width="3" height="10"/></div></p></blockquote><p>Considering the simplicity of the problem, the amount of &ldquo;work&rdquo; that the
program performs is surprising. If we were to convert the same list by
hand, we would tally up the total distance and just add it to the relative
distances as we take another step along the line. Why can&rsquo;t a program use
this idea?</p><p><div class="SIntrapara">Let&rsquo;s attempt to design a second version of the function that is closer to
our manual method. The new function is still a list-processing function, so we
start from the appropriate template:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Now imagine an &ldquo;evaluation&rdquo; of <span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">7</span><span class="RktPn">)</span><span class="RktPn">)</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The first item of the result list should obviously be <span class="RktVal">3</span>, and it is
easy to construct this list. But, the second one should be <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span>, yet the second instance of <span class="RktSym">relative-&gt;absolute/a</span> has no way of
&ldquo;knowing&rdquo; that the first item of the <span style="font-weight: bold">original</span> list is
<span class="RktVal">3</span>. The &ldquo;knowledge&rdquo; is lost.</div></p><p>Put differently, the problem is that recursive functions are independent of
their context. A function processes <span class="RktSym">L</span> in <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="stt"> </span><span class="RktSym">N</span><span class="stt"> </span><span class="RktSym">L</span><span class="RktPn">)</span> in
the same manner as in <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="stt"> </span><span class="RktSym">K</span><span class="stt"> </span><span class="RktSym">L</span><span class="RktPn">)</span>. Indeed, it would also process
<span class="RktSym">L</span> in that manner if it were given <span class="RktSym">L</span> by itself.</p><p>To make up for the loss of &ldquo;knowledge,&rdquo; we equip the function with an
additional parameter: <span class="RktSym">accu-dist</span>. The new parameter represents
the accumulated distance, which is the tally that we keep when we convert a
list of relative distances to a list of absolute distances. Its initial
value must be <span class="RktVal">0</span>. As the function processes the numbers on the list,
it must add them to the tally.</p><p><div class="SIntrapara">Here is the revised definition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="hspace">&nbsp;</span><span class="RktSym">accu-dist</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tally</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accu-dist</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tally</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">tally</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The recursive application consumes the rest of the list and the new
absolute distance of the current point to the origin. Although this means
that two arguments are changing simultaneously, the change in the second
one strictly depends on the first argument. The function is still a plain
list-processing procedure.</div></p><p><div class="SIntrapara">Evaluating our running example <span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">7</span><span class="RktPn">)</span><span class="RktPn">)</span> again,
shows how much the use of an accumulator simplifies the conversion process:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Each item in the list is processed once. When <span class="RktSym">relative-&gt;absolute/a</span> reaches
the end of the argument list, the result is completely determined and no
further work is needed. In general, the function performs on the order of
<span style="font-style: italic">N</span> natural recursion steps for a list with <span style="font-style: italic">N</span> items.</div></p><p>One minor problem with the new definition is that unlike
<span class="RktSym">relative-&gt;absolute</span>, the new function consumes two arguments not
just one. Worse, someone might accidentally misuse <span class="RktSym">relative-&gt;absolute/a</span> by
applying it to a list of numbers and a number that isn&rsquo;t <span class="RktVal">0</span>. We can
solve both problems with a function definition that uses a <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span>
definition to encapsulate <span class="RktSym">relative-&gt;absolute/a</span>;
<a href="part_six.html#%28counter._%28figure._fig~3arel-abs-human%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">104</span></a> shows the result.  Now,
<span class="RktSym">relative-&gt;absolute</span> and <span class="RktSym">relative-&gt;absolute.v2</span> are
indistinguishable with respect to the input-output relationship.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">convert a list of relative distances to a list of absolute distances</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the first item on the list represents the distance to the origin</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute.v2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">70</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">160</span><span class="hspace">&nbsp;</span><span class="RktVal">190</span><span class="hspace">&nbsp;</span><span class="RktVal">220</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="hspace">&nbsp;</span><span class="RktSym">accu-dist</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">accu</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accu-dist</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">accu</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accu</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3arel-abs-human))" x-target-lift="Figure"></a>Figure&nbsp;104: </span>Converting relative distances with an accumulator</span></p></blockquote><p><div class="SIntrapara">Now let&rsquo;s look at how this version of the program performs. To this
end, we evaluate
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute.v2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">size</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">and tabulate the results for several values of <span class="RktSym">size</span>:</div></p><p><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td align="right"><p><span class="RktSym">size</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>2000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>3000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>4000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>6000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>7000</p></td></tr><tr><td align="right"><p>time</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>0</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>0</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>0</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>0</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>0</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1</p></td></tr></table></blockquote></div><div class="SIntrapara">Amazingly <span class="RktSym">relative-&gt;absolute.v2</span> never takes more than one second to
process such lists, even for a list of <span style="font-style: italic"></span>7<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> numbers. Comparing this
performance to the one of <span class="RktSym">relative-&gt;absolute</span>, you may think that
accumulators are a miracle cure for all slow-running
programs. Unfortunately, this isn&rsquo;t the case, but when a structurally
recursive functions has to re-process the result of the natural recursion
you should definitely consider the use of accumulators.</div></p><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3arel-abs-from-reverse))"></a><span style="font-weight: bold">Exercise</span>&nbsp;403. With a bit of design and a bit of
 tinkering a friend of yours came up with the following solution for the
 sample problem:<span class="refelem"><span class="refcolumn"><span class="refcontent">Messrs. Adrian German and Mardin Yadegar
suggested this exercise.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">convert a list of relative distances to a list of absolute distances</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the first item on the list represents the distance to the origin</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">70</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">160</span><span class="hspace">&nbsp;</span><span class="RktVal">190</span><span class="hspace">&nbsp;</span><span class="RktVal">220</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">relative-&gt;absolute</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29" class="RktValLink" data-pltdoc="x">foldr</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This simple solution merely uses well-known ISL+ functions:
 <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span> and <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29" class="RktValLink" data-pltdoc="x">foldr</a></span>. Using <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span>, as you know,
 is just a convenience. You may also recall from <a href="part_three.html" data-pltdoc="x">Abstraction</a> that
 <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29" class="RktValLink" data-pltdoc="x">foldr</a></span> is designable with the design recipes presented in the
 first two parts of the book.</div></p><p>Does your friend&rsquo;s solution mean there is no need for our complicated
 design in this motivational section? xFor a solution, see
 <a href="part_six.html#%28part._sec~3aneed-accu%29" data-pltdoc="x">Recognizing the Need for an Accumulator</a>, but do reflect on the question first and better
 still try to design <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span> on your own. <img src="pict_469.png" alt="image" width="3" height="10"/></p></blockquote><h4>36.2<tt>&nbsp;</tt><a name="(part._sec~3aloss~3agenerative)"></a>A Problem with Generative Recursion</h4><p><div class="SIntrapara">Let us revisit the problem of &ldquo;traveling&rdquo; along a path in a graph:
</div><div class="SIntrapara"><blockquote><p><span style="font-weight: bold">Sample Problem: </span>Design an algorithm that checks whether two nodes are
connected in a simple graph. In a <span style="font-style: italic">simple graph</span>, each node has
exactly one, one-directional connection to another node, possibly itself.</p></blockquote></div><div class="SIntrapara"><a href="part_five.html#%28part._ch~3abacktrack%29" data-pltdoc="x">Algorithms that Backtrack</a> covered the variant where the algorithm has to
discover the path. This sample problem is simpler than that, because this
section focuses on the design of an accumulator version of the algorithm.</div></p><p>Consider the sample graph in <a href="part_six.html#%28counter._%28figure._fig~3asim-graph%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">105</span></a>. There are six
nodes: <span style="font-style: italic">A</span> through <span style="font-style: italic">F</span>, and six connections. To get from <span style="font-style: italic">A</span>
to <span style="font-style: italic">E</span>, you must go through <span style="font-style: italic">B</span> and <span style="font-style: italic">C</span>. It is impossible,
though, to reach <span style="font-style: italic">F</span> from <span style="font-style: italic">A</span> or from any other node besides
<span style="font-style: italic">F</span> itself.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0"><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_470.png" alt="image" width="355.8" height="72.0"/></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3asim-graph))" x-target-lift="Figure"></a>Figure&nbsp;105: </span>A simple graph</span></p></blockquote><p><div class="SIntrapara">The right part of <a href="part_six.html#%28counter._%28figure._fig~3asim-graph%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">105</span></a> shows how to represent this
graph with nested lists.  Each node is represented by a list of two symbols. The
first symbol is the label of the node; the second one is the single node
that is reachable from the first one. Here are the relevant data definitions:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._simplegraph)"></a><span style="font-style: italic">SimpleGraph</span><span class="RktCmt"> is a [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">Connection</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._connection)"></a><span style="font-style: italic">Connection</span><span class="RktCmt"> is </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="stt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._node)"></a><span style="font-style: italic">Node</span><span class="RktCmt"> is a </span><a href="i2-3.html#%28tech._symbol%29" class="techoutside" data-pltdoc="x"><span class="techinside">Symbol</span></a></td></tr></table></blockquote></div><div class="SIntrapara">They are straightforward translations of our informal descriptions.</div></p><p><div class="SIntrapara">We already know that the problem calls for generative recursion, and it is
easy to create the header material:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is there a path from </span><span class="RktSym">origination</span><span class="RktCmt"> to </span><span class="RktSym">destination</span><span class="RktCmt"> in </span><span class="RktSym">sg</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">What we need are answers to the four basic questions of the recipe for
generative recursion:
</div><div class="SIntrapara"><ul><li><p>The problem is trivial if the nodes <span class="RktSym">origination</span> and
<span class="RktSym">destination</span> are the same.</p></li><li><p>The trivial solution is <span class="RktVal">#true</span>.</p></li><li><p>If <span class="RktSym">origination</span> is not the same as <span class="RktSym">destination</span>,
there is only one thing we can do: step to the immediate neighbor and
search for <span class="RktSym">destination</span> from there.</p></li><li><p>There is no need to do anything if we find the solution to the new problem.
If <span class="RktSym">origination</span>&rsquo;s neighbor is connected to <span class="RktSym">destination</span>,
then so is <span class="RktSym">origination</span>. Otherwise there is no connection.</p></li></ul></div><div class="SIntrapara">From here we just need to express these answers in ISL+ to obtain a
full-fledged program.</div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is there a path from </span><span class="RktSym">origination</span><span class="RktCmt"> to </span><span class="RktSym">destination</span><span class="RktCmt"> in </span><span class="RktSym">sg</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> -&gt; </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determine the node that is connected to </span><span class="RktSym">a-node</span><span class="RktCmt"> in </span><span class="RktSym">sg</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">B</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-error%29%29" class="RktStxLink" data-pltdoc="x">check-error</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">G</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"neighbor: not a node"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktSym">a-node</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"neighbor: not a node"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a-node</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29" class="RktValLink" data-pltdoc="x">second</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktSym">a-node</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3apath-exists1))" x-target-lift="Figure"></a>Figure&nbsp;106: </span>Finding a path in a simple graph</span></p></blockquote><p><a href="part_six.html#%28counter._%28figure._fig~3apath-exists1%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">106</span></a> contains the complete program, including the
function for looking up the neighbor of a node in a simple graph&#8212;<wbr></wbr>a
straightforward exercise in structural recursion&#8212;<wbr></wbr>and test cases for
both. Don&rsquo;t run the program, however. If you do, be ready with your mouse
to stop the run-away program.  Indeed, even a casual look at the function
suggests that we have a problem. Although the function is supposed to
produce <span class="RktVal">#false</span> if there is no path from <span class="RktSym">origination</span> to
<span class="RktSym">destination</span>, the program doesn&rsquo;t contain <span class="RktVal">#false</span>
anywhere. Conversely, we need to ask what the function actually does when
there is no path between two nodes.</p><p><div class="SIntrapara">Take another look at <a href="part_six.html#%28counter._%28figure._fig~3asim-graph%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">105</span></a>. In this simple graph there
is no path from <span style="font-style: italic">C</span> to <span style="font-style: italic">D</span>. The connection that leaves <span style="font-style: italic">C</span>
passes right by <span style="font-style: italic">D</span> and instead goes to <span style="font-style: italic">E</span>. So let&rsquo;s look at how
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">is evaluated:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The hand-evaluation confirms that as the function recurs, it calls itself
with the exact same arguments again and again. In other words, the
evaluation never stops.</div></p><p>Our problem with <span class="RktSym">path-exists?</span> is again a loss of &ldquo;knowledge,&rdquo;
similar to that of <span class="RktSym">relative-&gt;absolute</span> in the preceding section.
Like <span class="RktSym">relative-&gt;absolute</span>, the design of <span class="RktSym">path-exists?</span>
uses a recipe and assumes context-independence for recursive calls. In the
case of <span class="RktSym">path-exists?</span>  this means, in particular, that the function
doesn&rsquo;t &ldquo;know&rdquo; whether a previous application in the current chain of
recursions received the exact same arguments.</p><p>The solution to this design problem follows the pattern of the preceding
section. We add a parameter, which we call <span class="RktSym">seen</span> and which
represents the accumulated list of origination nodes that the function has
encountered, starting with the original application. Its initial value must
be <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>. As the function checks on a specific
<span class="RktSym">origination</span> and moves to its neighbors, <span class="RktSym">origination</span> is
added to <span class="RktSym">seen</span>.</p><p><div class="SIntrapara">Here is a first revision of <span class="RktSym">path-exists?</span>, dubbed
<span class="RktSym">path-exists?/a</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt">] -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is there a path from </span><span class="RktSym">origination</span><span class="RktCmt"> to </span><span class="RktSym">destination</span><span class="RktCmt"> in </span><span class="RktSym">sg</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">assume</span><span class="RktCmt"> the nodes in </span><span class="RktSym">seen</span><span class="RktCmt"> are known not to solve the problem</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The addition of the new parameter alone does not solve our problem, but, as
the hand-evaluation of
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">shows, provides the foundation for one:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">C</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">D</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">B</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktVal">F</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="hspace">&nbsp;</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktVal">C</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">In contrast to the original function, the revised function no longer calls
itself with the exact same arguments. While the three arguments proper are
again the same for the third recursive application, the accumulator
argument is different from that of the first application. Instead of
<span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>, it is now <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">B</span><span class="stt"> </span><span class="RktVal">E</span><span class="stt"> </span><span class="RktVal">C</span><span class="RktVal">)</span>. The new value represents the
fact that during the search of a path from <span class="RktVal">'</span><span class="RktVal">C</span> to <span class="RktVal">'</span><span class="RktVal">D</span>, the
function has inspected <span class="RktVal">'</span><span class="RktVal">B</span>, <span class="RktVal">'</span><span class="RktVal">E</span>, and <span class="RktVal">'</span><span class="RktVal">C</span> as starting
points.</div></p><p>All we need to do now, is to make the algorithm exploit the accumulated
knowledge. Specifically, the algorithm can determine whether the given
<span class="RktSym">origination</span> is already an item in <span class="RktSym">seen</span>. If so, the
problem is also trivially solvable yielding <span class="RktVal">#false</span> as the
solution. <a href="part_six.html#%28counter._%28figure._fig~3apath-exists2%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">107</span></a> contains the definition of
<span class="RktSym">path-exists.v2?</span>, which is the revision of <span class="RktSym">path-exists?</span>. The
definition refers to <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span>, an ISL+ function.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is there a path from </span><span class="RktSym">origination</span><span class="RktCmt"> to </span><span class="RktSym">destination</span><span class="RktCmt"> in </span><span class="RktSym">sg</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists.v2?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">E</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists.v2?</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">F</span><span class="hspace">&nbsp;</span><span class="RktSym">a-simple-graph</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists.v2?</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._simplegraph%29" class="techoutside" data-pltdoc="x"><span class="techinside">SimpleGraph</span></a><span class="RktCmt"> [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._node%29" class="techoutside" data-pltdoc="x"><span class="techinside">Node</span></a><span class="RktCmt">] -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">destination</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">neighbor</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">sg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path-exists?/a</span><span class="hspace">&nbsp;</span><span class="RktSym">origination</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3apath-exists2))" x-target-lift="Figure"></a>Figure&nbsp;107: </span>Finding a path in a simple graph with an accumulator</span></p></blockquote><p>The definition of <span class="RktSym">path-exists.v2?</span> also eliminates the two minor
problems with the first revision. By localizing the definition of the
accumulating function, we can ensure that the first call always uses
<span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span> as the initial value for <span class="RktSym">seen</span>. And,
<span class="RktSym">path-exists.v2?</span> satisfies the exact same contract and purpose
statement as the <span class="RktSym">path-exists?</span> function.</p><p>Still, there is a significant difference between <span class="RktSym">path-exists.v2?</span>
and <span class="RktSym">relative-to-absolute2</span>. Whereas the latter was equivalent to
the original function, <span class="RktSym">path-exists.v2?</span> improves on
<span class="RktSym">path-exists?</span>.  While the latter fails to find an answer for some
inputs, <span class="RktSym">path-exists.v2?</span> finds a solution for any simple graph.</p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afind-path-comp))"></a><span style="font-weight: bold">Exercise</span>&nbsp;404. Modify the definitions of <span class="RktSym">find-path</span>
and <span class="RktSym">find-path/list</span> in <a href="part_five.html#%28counter._fsm._%28figure._fig~3afind-path-code%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">97</span></a> so that they
produce <span class="RktVal">#false</span>, even if they encounter the same starting point
twice. <img src="pict_471.png" alt="image" width="3" height="10"/></p></blockquote><h3>37<tt>&nbsp;</tt><a name="(part._sec~3adesign-accu)"></a>Designing Accumulator-Style Functions</h3><p>The preceding chapter illustrates the need for accumulating extra knowledge
with two examples. In one case, accumulation makes it easy to understand
the function and yields one that is far faster than the original
version. In the other case, accumulation is necessary for the function to
work properly. In both cases though, the need for accumulation becomes only
apparent once a properly designed function exists.</p><p><div class="SIntrapara">Generalizing from the preceding chapter suggests that the design of
accumulator functions has two major aspects:
</div><div class="SIntrapara"><ol><li><p>the recognition that a function benefits from an accumulator;</p></li><li><p>an understanding of what the accumulator represents with respect to
the design.</p></li></ol></div><div class="SIntrapara">The first two sections address these two questions. Because the second
one is a difficult topic, the third section illustrates it with a series
of examples that convert regular functions into accumulating ones.</div></p><h4>37.1<tt>&nbsp;</tt><a name="(part._sec~3aneed-accu)"></a>Recognizing the Need for an Accumulator</h4><p><div class="SIntrapara">Recognizing the need for accumulators is not an easy task. We have seen two
reasons, and they are the most prevalent reasons for adding accumulator
parameters. In either case, it is critical that we first built a complete
function based on a design recipe. Then we study the function and
look for one of the following characteristics:
</div><div class="SIntrapara"><ol><li><p>If a structurally recursive function processes the result of its
natural recursion with an auxiliary, recursive function, consider the use
of an accumulator parameter.</p><p><div class="SIntrapara">Take a look at the definition of <span class="RktSym">invert</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">construct the reverse of </span><span class="RktSym">alox</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">a</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">X [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">add </span><span class="RktSym">an-x</span><span class="RktCmt"> to the end of </span><span class="RktSym">alox</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">a</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktSym">an-x</span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">an-x</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktSym">an-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The result of the recursive application produces the reverse of the rest of
the list. It is processed by <span class="RktSym">add-as-last</span>, which adds the first
item to the reverse of the rest and thus creates the reverse of the entire
list.  This second, auxiliary function is also recursive. We have thus
identified a potential candidate.</div></p><p><div class="SIntrapara">It is now time to study some hand-evaluations, as we did in
<a href="part_six.html#%28part._sec~3aloss~3astructural%29" data-pltdoc="x">A Problem with Structural Processing</a>, to see whether an accumulator helps. Consider the
following expression:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Here is how you calculate how <span class="RktSym">invert</span> determines the result when given
<span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="stt"> </span><span class="RktVal">b</span><span class="stt"> </span><span class="RktVal">c</span><span class="RktVal">)</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-as-last</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">a</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Eventually <span class="RktSym">invert</span> reaches the end of the given list&#8212;<wbr></wbr>just like
<span class="RktSym">add-as-last</span>&#8212;<wbr></wbr>and if it knew which items to put there, there would be
no need for the auxiliary function.</div></p></li><li><p>If we are dealing with a function based on generative recursion, we
are faced with a much more difficult task. Our goal must be to understand
whether the algorithm can fail to produce a result for inputs for which we
expect a result. If so, adding a parameter that accumulates knowledge may
help. Because these situations are complex, we defer the discussion of
an example to <a href="part_six.html#%28part._ch~3amore-accu%29" data-pltdoc="x">More Uses of Accumulation</a>.</p></li></ol></div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3aneed-accu))"></a><span style="font-weight: bold">Exercise</span>&nbsp;405. Does the insertion <span class="RktSym">sort&gt;</span> function from
<a href="part_two.html#%28part._sec~3asort.I%29" data-pltdoc="x">Recursive Auxiliary Functions</a> need an accumulator? If so, why? If not, why not? <img src="pict_472.png" alt="image" width="3" height="10"/></p></blockquote><h4>37.2<tt>&nbsp;</tt><a name="(part._sec~3aaccu-style)"></a>Adding Accumulators</h4><p><div class="SIntrapara">Once you have decided that an existing function should be equipped with an
accumulator, take these two steps:
</div><div class="SIntrapara"><ul><li><p>Determine the knowledge that the accumulator represents, what kind of data
to use, and how the knowledge is acquired as data.</p><p>For example, for the conversion of relative distances to absolute
distances, it suffices to accumulate the total distance encountered so
far. As the function processes the list of relative distances, it adds each
new relative distance found to the accumulator&rsquo;s current value.  For the
routing problem, the accumulator remembers every node encountered. As the
path-checking function traverses the graph, it <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span>es each new
node on to the accumulator.</p><p><div class="SIntrapara">In general, you want to proceed as follows.
</div><div class="SIntrapara"><ol><li><p><div class="SIntrapara">Create an accumulator template:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Domain -&gt; Range </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function</span><span class="hspace">&nbsp;</span><span class="RktSym">d0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Domain AccumulatorDomain -&gt; Range</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function/a</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function/a</span><span class="hspace">&nbsp;</span><span class="RktSym">d0</span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Sketch a manual evaluation of an application of <span class="RktSym">function</span> to understand
the nature of the accumulator.</div></p></li><li><p>Determine the kind of data that the accumulator tracks.</p><p>Write down a statement that explains the accumulator as a relationship between
the argument <span class="RktSym">d</span> of the auxiliary <span class="RktSym">function/a</span> and the original
argument <span class="RktSym">d0</span>.</p><p><span style="font-weight: bold">Note</span> The relationship remains constant&#8212;<wbr></wbr>also called
<span style="font-weight: bold">invariant</span>&#8212;<wbr></wbr>over the course of the evaluation. Because of this property,
an accumulator statement is also called an accumulator <span style="font-style: italic">invariant</span>.</p></li><li><p>Use the accumulator statement to determine the initial value
<span class="RktSym">a0</span> for <span class="RktSym">a</span>.</p></li><li><p>Also exploit the accumulator statement to determine how to compute
the accumulator for the recursive function calls within the definition of
<span class="RktSym">function/a</span>.</p></li></ol></div></p></li><li><p>Exploit the accumulator&rsquo;s knowledge for the design of the auxiliary
function.</p><p>For a structurally recursive function, the accumulator&rsquo;s value is typically used
in the base case, that is, the <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clause that does not recur. For
functions that use generative recursive functions, the accumulated knowledge
might be used in an existing base case, in a new base case, or in the
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clauses that deal with generative recursion.</p></li></ul></div><div class="SIntrapara">As you can see, the key is the precise description of the role of the
accumulator. It is therefore important to practice this skill.</div></p><p><div class="SIntrapara">Let&rsquo;s take a look at the <span class="RktSym">invert</span> example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">construct the reverse of </span><span class="RktSym">alox0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert.v2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">a</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">alox0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] ??? -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">construct the reverse of </span><span class="RktSym">alox</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alox0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">As illustrated in the preceding section, this template suffices to sketch a
manual evaluation of an expression such as
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">invert</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Here is the idea:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">b</span><span class="hspace">&nbsp;</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a0</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">c</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">b</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a0</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">c</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">b</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a0</span></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This sketch suggests that <span class="RktSym">invert/a</span> can keep track of all the items it
has seen in a list that tracks the difference between <span class="RktSym">alox0</span> and
<span class="RktSym">a</span> in reverse order. The initial value is clearly <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>; updating
the accumulator inside of <span class="RktSym">invert/a</span> with <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span> produces exactly
the desired value when <span class="RktSym">invert/a</span> reaches <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>.</div></p><p><div class="SIntrapara">Here is a refined template that includes these insights:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">alox0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> X]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">construct the reverse of </span><span class="RktSym">alox</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> is the list of all those items</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">on </span><span class="RktSym">alox0</span><span class="RktCmt"> that precede </span><span class="RktSym">alox</span><span class="RktCmt"> in reverse order</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym">a</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alox</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">alox</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">a</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">invert/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alox0</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktVal">'</span></span><span class="highlighted"><span class="RktVal">(</span></span><span class="highlighted"><span class="RktVal">)</span></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">While the body of the <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> definition initializes the accumulator
with <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>, the recursive call uses <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span> to add the current
head of <span class="RktSym">alox</span> to the accumulator. In the base case, <span class="RktSym">invert/a</span>
uses the knowledge in the accumulator&#8212;<wbr></wbr>the reversed list.</div></p><p>Note how once again <span class="RktSym">invert.v2</span> traverses the list just. In
contrast, <span class="RktSym">invert</span> re-processes every result of its natural
recursion with <span class="RktSym">add-as-last</span>. Stop! Measure how much faster
<span class="RktSym">invert.v2</span> runs than <span class="RktSym">invert</span> on the same list.</p><p><span style="font-weight: bold">Terminology</span> Programmers use the phrase <span style="font-style: italic">accumulator-style
function</span> when they discuss functions that use an accumulator
parameter. Examples of functions in accumulator-style are
<span class="RktSym">relative-&gt;absolute/a</span>, <span class="RktSym">path-exists?/a</span>, and
<span class="RktSym">invert/a</span>.</p><h4>37.3<tt>&nbsp;</tt><a name="(part._sec~3atrans-accu)"></a>Transforming Functions into Accumulator-Style</h4><p>Articulating the accumulator statement is difficult but without formulating
a good invariant, it is impossible to understand an accumulator-style
function. Since the goal of a programmer is to make sure that others who
follow understand the code easily, practicing this skill is critical. And
formulating invariants is deserves a lot of practice.</p><p>The goal of this section is to study the formulation of accumulator
statements with three case studies: a summation function, the factorial
function, and a tree-traversal function. Each such case is about the
conversion of a structurally recursive function into accumulator
style. None actually call for the use of an accumulator parameter. But they
are easily understood and, with the elimination of all other distractions,
using such examples allows us to focus on the articulation of the
accumulator invariant.</p><p><div class="SIntrapara">For the first example, consider the following definition of the
<span class="RktSym">sum</span> function:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute the sum of the numbers on </span><span class="RktSym">alon</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Here is the first step toward an accumulator version:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] -&gt; </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute the sum of the numbers on </span><span class="RktSym">alon0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] ??? -&gt; </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute the sum of the numbers on </span><span class="RktSym">alon</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">As suggested by our first step, we have put the template for <span class="RktSym">sum/a</span>
into a <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> definition, added an accumulator parameter, and
renamed <span class="RktSym">sum</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">s</span> parameter.</div></p><p><div class="SIntrapara">Here are two side-by-side sketches of hand evaluations:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktPn">(</span><span class="RktSym">sum</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td></tr><tr><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">4</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span></td></tr></table></blockquote></td><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">4</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span></td></tr></table></blockquote></td></tr></table></div><div class="SIntrapara">A comparison immediately suggests the central idea, namely, that
<span class="RktSym">sum/a</span> can use the accumulator to add up the numbers as it
encounters.</div></p><p><div class="SIntrapara">Concerning the accumulator invariant, this analysis suggest
<span class="RktSym">a</span> represents the sum of the numbers encountered so far:
</div><div class="SIntrapara"><blockquote><p><span class="RktSym">a</span> represents the sum of the numbers that <span class="RktSym">alon</span> lacks in comparison to <span class="RktSym">alon0</span></p></blockquote></div><div class="SIntrapara">For example, if</div></p><p><div class="SIntrapara"><blockquote class="SCentered"><table cellspacing="0" cellpadding="0"><tr><td align="right"><p><span class="RktSym">alon0</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">4</span><span class="stt"> </span><span class="RktVal">6</span><span class="RktVal">)</span></p></td></tr><tr><td align="right"><p><span class="RktSym">alon</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">6</span><span class="RktVal">)</span></p></td></tr></table></blockquote></div><div class="SIntrapara">the invariant forces the accumulator&rsquo;s value to be <span class="RktVal">14</span>. In
contrast, when
</div><div class="SIntrapara"><blockquote class="SCentered"><table cellspacing="0" cellpadding="0"><tr><td align="right"><p><span class="RktSym">alon0</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">4</span><span class="stt"> </span><span class="RktVal">6</span><span class="RktVal">)</span></p></td></tr><tr><td align="right"><p><span class="RktSym">alon</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></p></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym">a</span> must be <span class="RktVal">20</span>.</div></p><p><div class="SIntrapara">Given this precise invariant, the rest of the design is straightforward again:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">] ??? -&gt; </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute the sum of the numbers on </span><span class="RktSym">alon</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> represents the sum of the numbers </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">that </span><span class="RktSym">alon</span><span class="RktCmt"> lacks in comparison to </span><span class="RktSym">alon0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktSym">alon0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">If <span class="RktSym">alon</span> is <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>, <span class="RktSym">sum/a</span> returns
<span class="RktSym">a</span> because it represents the sum of all numbers on <span class="RktSym">alon</span>.
The invariant also implies that <span class="RktVal">0</span> is the initial value for
<span class="RktSym">a0</span> and <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span> updates the accumulator by adding the number
that is about to be &ldquo;forgotten&rdquo;&#8212;<wbr></wbr><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="stt"> </span><span class="RktSym">alox</span><span class="RktPn">)</span>&#8212;<wbr></wbr>to the
accumulator <span class="RktSym">a</span>.</div></p><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3asum-a))"></a><span style="font-weight: bold">Exercise</span>&nbsp;406. Explain why the natural recursion maintains the
correctness of the accumulator statement:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">alon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Study the above examples before you formulate a general argument. <img src="pict_473.png" alt="image" width="3" height="10"/></div></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3asum-accu-inex))"></a><span style="font-weight: bold">Exercise</span>&nbsp;407. Complete the above manual evaluation of
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">sum/a</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Doing so shows that the <span class="RktSym">sum</span> and <span class="RktSym">sum.v2</span> add up the given
numbers in reverse order. While <span class="RktSym">sum</span> adds up the numbers from right
to left, the accumulator-style version adds them up from left to right. <img src="pict_474.png" alt="image" width="3" height="10"/></div></p></blockquote><p><div class="SIntrapara"><span style="font-weight: bold">Note</span> For exact numbers, this difference has no effect on the final
result. For inexact numbers, the difference is significant. Consider the
following definition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._expt%29%29" class="RktValLink" data-pltdoc="x">expt</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-0</span>.99</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Applying <span class="RktSym">g-series</span> to a natural number produces the beginning of a
so-called geometric series. The numbers in this series rapidly oscillate
in the interval <span style="font-style: italic"></span>(<span style="font-style: italic">-</span>1<span style="font-style: italic">,+</span>1<span style="font-style: italic"></span>)<span style="font-style: italic"></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">#i-0.9509900498999999</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">#i0.96059601</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">#i-0.970299</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">#i0.9801</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">#i-0.99)</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Each summation function computes a different sum for the same series:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktVal">1000.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#i-0.49746596003269394</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktVal">1000.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#i-0.49746596003269533</span></p></td></tr></table></blockquote></div><div class="SIntrapara">While the difference may appear to be small, imagine a context where the
actual calculation is something like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1e+16</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktVal">1000.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1e+16</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum.v2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g-series</span><span class="hspace">&nbsp;</span><span class="RktVal">1000.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">#i14.0</span></p></td></tr></table></blockquote></div><div class="SIntrapara">And now the difference matters. <span style="font-weight: bold">End</span></div></p><p><div class="SIntrapara">For the second example, we turn to the well-known factorial
function:<span class="refelem"><span class="refcolumn"><span class="refcontent">The factorial function is useful in certain areas of
mathematics and in some programming libraries. No ordinary programmer has a
need to know the function for its own sake.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">While <span class="RktSym">relative-2-absolute</span> and <span class="RktSym">invert</span> processed lists,
the factorial function works on natural numbers. Its template is that for
<a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a> processing functions.</div></p><p><div class="SIntrapara">We proceed as before by with a template for an accumulator-style version:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktSym">n0</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n0</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n0</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!.v2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">n0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> ??? -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktSym">n0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">followed by a sketch of a hand evaluation:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktPn">(</span><span class="RktSym">!</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">!.v2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span></p></td></tr><tr><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">6</span></td></tr></table></blockquote></td><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">6</span></td></tr></table></blockquote></td></tr></table></div><div class="SIntrapara">The left column shows how the original version works, the right one
sketches how the accumulator-style function proceeds. Both traverse the
natural number until they reach <span class="RktVal">0</span>. While the original version schedules only
multiplications, the accumulator keeps track of each number as the
structural processing descends through the given natural number.</div></p><p><div class="SIntrapara">Given the goal of multiplying these numbers, <span class="RktSym">!/a</span> can use the
accumulator to multiply the numbers immediately:
</div><div class="SIntrapara"><blockquote><p><span class="RktSym">a</span> is the product of the natural numbers in the interval [<span class="RktSym">n0</span>,<span class="RktSym">n</span>).</p></blockquote></div><div class="SIntrapara">In particular, when <span class="RktSym">n0</span> is <span class="RktVal">3</span> and <span class="RktSym">n</span> is <span class="RktVal">1</span>,
<span class="RktSym">a</span> is <span class="RktVal">6</span>.</div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afactorial-inv))"></a><span style="font-weight: bold">Exercise</span>&nbsp;408. What should the value of <span class="RktSym">a</span> be when
<span class="RktSym">n0</span> is <span class="RktVal">3</span> and <span class="RktSym">n</span> is <span class="RktVal">1</span>? How about when
<span class="RktSym">n0</span> is <span class="RktVal">10</span> and <span class="RktSym">n</span> is <span class="RktVal">8</span>? <img src="pict_475.png" alt="image" width="3" height="10"/></p></blockquote><p><div class="SIntrapara">Using this invariant we can easily pick the initial value for
<span class="RktSym">a</span>&#8212;<wbr></wbr>it is <span class="RktVal">1</span>&#8212;<wbr></wbr>and we know that multiplication the current
accumulator with <span class="RktSym">n</span> is the proper update operation:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">n0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">compute </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> is the product of the natural </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">numbers in the interval [</span><span class="RktSym">n0</span><span class="RktCmt">,</span><span class="RktSym">n</span><span class="RktCmt">).</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!/a</span><span class="hspace">&nbsp;</span><span class="RktSym">n0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">It also follows from the accumulator statement that when <span class="RktSym">n</span> is
<span class="RktVal">0</span>, the accumulator is the product of <span class="RktSym">n</span> through
<span class="RktVal">1</span>, meaning it is the desired result. So, like <span class="RktSym">sum</span>,
<span class="RktSym">!/a</span> returns <span class="RktSym">a</span> in this case and uses the result of the
recursion in the second case.</div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3atime-factorial))"></a><span style="font-weight: bold">Exercise</span>&nbsp;409. Like <span class="RktSym">sum</span>, <span class="RktSym">!</span><span class="RktMeta"></span> performs the
primitive computation steps&#8212;<wbr></wbr>multiplication in this case&#8212;<wbr></wbr>in reverse
order. Surprisingly, this affects the performance of the function in a
negative manner.</p><p>Measure how long it takes to evaluate <span class="RktPn">(</span><span class="RktSym">!</span><span class="stt"> </span><span class="RktVal">20</span><span class="RktPn">)</span> one thousand
times. Recall that <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._time%29%29" class="RktStxLink" data-pltdoc="x">time</a></span><span class="stt"> </span><span class="RktSym">an-expression</span><span class="RktPn">)</span> function determines how
long it takes to run <span class="RktSym">an-expression</span>. <img src="pict_476.png" alt="image" width="3" height="10"/></p></blockquote><p>For the third and last example, we use a function that measures the height
of simplified binary trees. The example illustrates that accumulator-style
programming applies to all kinds of data, not just those defined with
single self-references. Indeed, it is as common for complicated data
definitions as it is for lists and natural numbers.</p><p><div class="SIntrapara">Here are the relevant definitions:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">node</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left</span><span class="hspace">&nbsp;</span><span class="RktSym">right</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._binarytree)"></a><span style="font-style: italic">BinaryTree</span><span class="RktCmt"> (short </span><a name="(tech._tree)"></a><span style="font-style: italic">Tree</span><span class="RktCmt">) is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> </span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="stt"> </span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="stt"> </span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">example</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">These trees carry no information; their leafs are <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>. Still,
 there are many different trees as <a href="part_six.html#%28counter._%28figure._fig~3asim-bt-ex%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">108</span></a> shows; it
 also uses suggestive graphics to bring across what these pieces of data
 look like as trees.</div></p><p><div class="SIntrapara">One property one may wish to compute is the height of such a tree:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktSym">example</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._max%29%29" class="RktValLink" data-pltdoc="x">max</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-left</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-right</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The table in <a href="part_six.html#%28counter._%28figure._fig~3asim-bt-ex%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">108</span></a> indicates how to measure the
 height of a tree though it leaves the notion somewhat ambiguous: it is
 either the number of nodes from the root of the tree to the highest leaf
 or the number of connections on such a path.  The <span class="RktSym">height</span> function
 follows the second option.</div></p><blockquote class="Figure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0"><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_477.png" alt="image" width="206" height="31"/></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><blockquote class="SCodeFlow"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></p></blockquote></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_478.png" alt="image" width="206" height="106"/></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_479.png" alt="image" width="206" height="231"/></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-node</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3asim-bt-ex))" x-target-lift="Figure"></a>Figure&nbsp;108: </span>Some stripped-down binary trees</span></p></blockquote><p><div class="SIntrapara">To transform this function into an accumulator-style function, we follow the
standard path. We begin with an appropriate template:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">example</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> ??? -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-left</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-right</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">As always, the problem is to determine what knowledge the accumulator
represents.  One obvious choice is the number of traversed branches:
</div><div class="SIntrapara"><blockquote><p><span class="RktSym">a</span> is the number of steps it takes to reach
<span class="RktSym">abt</span> from <span class="RktSym">abt0</span>.</p></blockquote></div></p><p><div class="SIntrapara">Illustrating this accumulator invariant is best done with a graphical example.
Take a second look at <a href="part_six.html#%28counter._%28figure._fig~3asim-bt-ex%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">108</span></a>.  The bottom-most tree comes
with two annotations, each pointing out one subtree:
</div><div class="SIntrapara"><ol><li><p>If <span class="RktSym">abt0</span> is the complete tree and <span class="RktSym">abt</span> is the subtree
pointed to by the circled <span style="font-style: italic"></span>1<span style="font-style: italic"></span>, the accumulator&rsquo;s value must be <span class="RktVal">1</span> because it
takes exactly one step to get from the root of <span class="RktSym">abt</span> to the root of
<span class="RktSym">abt0</span>.</p></li><li><p>In the same spirit, for the subtree labeled <span style="font-style: italic"></span>2<span style="font-style: italic"></span> the accumulator is
<span class="RktVal">2</span> because it takes two steps to get this place.</p></li></ol></div></p><p><div class="SIntrapara">As for the preceding two examples, the invariant basically dictates how to follow
the rest of the design recipe for accumulators: the initial value for <span class="RktSym">a</span>
is <span class="RktVal">0</span>; the update operation is <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span>; and the base case uses the
accumulated knowledge by returning it. Translating this into code yields the
following skeleton definition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> is the number of steps </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">it takes to reach </span><span class="RktSym">abt</span><span class="RktCmt"> from </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-left</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-right</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">But, in contrast to the first two examples, <span class="RktSym">a</span> is not the final
result. In the second <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clause, the two recursive calls yield two
values. The design recipe for structural functions dictate that we combine those
in order to formulate an answer for this case; the dots above indicate that we
still need to pick an operation that combines these values.</div></p><p>Following the design recipe also tells us that we need to interpret the two
values to find the appropriate function. According to the purpose statement for
<span class="RktSym">height/a</span>, the first value is the height of the left subtree, and the
second one is the height of the right one. Given that we are interested in the
height of <span class="RktSym">abt</span> itself and that the height is the largest number of steps
it takes to reach a leaf, we use the <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._max%29%29" class="RktValLink" data-pltdoc="x">max</a></span> function to pick the proper
one; see <a href="part_six.html#%28counter._%28figure._fig~3aheight-accu%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">109</span></a> for the complete definition.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">example</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> is the number of steps </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">it takes to reach </span><span class="RktSym">abt</span><span class="RktCmt"> from </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._max%29%29" class="RktValLink" data-pltdoc="x">max</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-left</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-right</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aheight-accu))" x-target-lift="Figure"></a>Figure&nbsp;109: </span>The accumulator-style version of <span style="font-style: italic">height</span></span></p></blockquote><p><div class="SIntrapara"><span style="font-weight: bold">Note on an Alternative Design</span> In addition to counting the number of
steps it takes to reach a node, an accumulator function could hold on to
the largest height encountered so far. Here is the accumulator statement
for the design idea:
</div><div class="SIntrapara"><blockquote><p>the first accumulator, <span class="RktSym">a</span>, represents the
number of steps it takes to reach <span class="RktSym">abt</span> from <span class="RktSym">abt0</span> and the
second accumulator, stands for the tallest branch in the part of
<span class="RktSym">abt0</span> that is to the left of <span class="RktSym">abt</span>.</p></blockquote></div><div class="SIntrapara">Clearly, this statement assumes a template with two accumulator parameters:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">height.v3</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._tree%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tree</span></a><span class="RktCmt"> </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">measure the height of </span><span class="RktSym">abt</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">s</span><span class="RktCmt"> is the number of steps </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">it takes to reach </span><span class="RktSym">abt</span><span class="RktCmt"> from </span><span class="RktSym">abt0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">m</span><span class="RktCmt"> is the maximal height of</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the part of </span><span class="RktSym">abt0</span><span class="RktCmt"> that is to the left of </span><span class="RktSym">abt</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-left</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">m</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">node-right</span><span class="hspace">&nbsp;</span><span class="RktSym">abt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym">m</span><span class="stt"> </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h/a</span><span class="hspace">&nbsp;</span><span class="RktSym">abt0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3aheight-accu))"></a><span style="font-weight: bold">Exercise</span>&nbsp;410. Complete the design of <span class="RktSym">height.v3</span>.</p><p><span style="font-weight: bold">Hint</span> In terms of the bottom-most tree of <a href="part_six.html#%28counter._%28figure._fig~3asim-bt-ex%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">108</span></a>,
the place marked <span style="font-style: italic"></span>1<span style="font-style: italic"></span> has no complete paths to leafs to its left while
the place marked <span style="font-style: italic"></span>2<span style="font-style: italic"></span> has one complete path and it consists of two
steps. <img src="pict_480.png" alt="image" width="3" height="10"/></p></blockquote><p>This second design has a more complex accumulator invariant than the first
one. By implication, its implementation requires more care than the first
one. At the same time, it comes without any advantages, meaning it is
inferior to the first one.</p><p>Our point is that different accumulator invariants yield different
variants.  You can design both variants systematically following the same
design recipe. When you have complete function definitions, you can compare
and contrast the results, and you can then decide which one to keep based
on evidence. <span style="font-weight: bold">End</span></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3api-accu))"></a><span style="font-weight: bold">Exercise</span>&nbsp;411. Design an accumulator-style version of <span class="RktSym">product</span>, the function that
computes the product of a list of numbers. Stop when you have formulated the
accumulator invariant and have someone check it. <img src="pict_481.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3alength-accu))"></a><span style="font-weight: bold">Exercise</span>&nbsp;412. Design an accumulator-style version of <span class="RktSym">how-many</span>, which is the function
that determines the number of items on a list. Stop when you have formulated the
accumulator invariant and have someone check it. <img src="pict_482.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3aadd-pi-accu))"></a><span style="font-weight: bold">Exercise</span>&nbsp;413. Design an accumulator-style version of
 <span class="RktSym">add-to-pi</span>, which adds a natural number to <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span> without using
 <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">add </span><span class="RktSym">n</span><span class="RktCmt"> to </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktCmt"> without use </span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-within%29%29" class="RktStxLink" data-pltdoc="x">check-within</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-pi</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0.001</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-pi</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-to-pi</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Stop when you have formulated the accumulator invariant and have someone check it. <img src="pict_483.png" alt="image" width="3" height="10"/></div></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3apalindrome))"></a><span style="font-weight: bold">Exercise</span>&nbsp;414. Design the function <span class="RktSym">make-palindrome</span>, which
accepts a non-empty list and constructs a palindrome by mirroring the list around
the last item.  When given <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="stt"> </span><span class="RktVal">"abc"</span><span class="RktPn">)</span>, it yields <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="stt"> </span><span class="RktVal">"abcba"</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">Hint</span> Here is a solution designed by function composition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[cons 1String [List-of 1String]] -&gt; [cons 1String [List-of 1String]]</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">create a palindrome by mirroring the given list around the last item</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mirror</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"abc"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"abcba"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mirror</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29" class="RktValLink" data-pltdoc="x">append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-but-last</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">last</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-but-last</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">See <a href="part_two.html#%28part._sec~3agen-funcs%29" data-pltdoc="x">Generalizing Functions</a> for <span class="RktSym">last</span>; design <span class="RktSym">all-but-last</span> in an
analogous manner. This solution traverses <span class="RktSym">s0</span> four times:
</div><div class="SIntrapara"><ol><li><p>via <span class="RktSym">all-but-last</span>,</p></li><li><p>via <span class="RktSym">last</span>,</p></li><li><p>via <span class="RktSym">all-but-last</span> again, and</p></li><li><p>via <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span>, which is ISL+&rsquo;s version of <span class="RktSym">inverse</span>.</p></li></ol></div><div class="SIntrapara">Even with <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> definition for the result of <span class="RktSym">all-but-last</span>, the
function needs three traversals. While these traversals aren&rsquo;t &ldquo;stacked&rdquo; and
therefore don&rsquo;t have a disastrous impact on the function&rsquo;s performance, an
accumulator version can compute the same result with a single traversal. <img src="pict_484.png" alt="image" width="3" height="10"/></div></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3agauss-fast))"></a><span style="font-weight: bold">Exercise</span>&nbsp;415. <a href="part_five.html#%28counter._%28exercise._ex~3atriangulate2%29%29" data-pltdoc="x">Exercise&nbsp;384</a> implicitly asks for the
design of a function that rotates a <a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a> until the first
coefficient of the first row differs from <span class="RktVal">0</span>. In the context of
<a href="part_five.html#%28counter._%28exercise._ex~3atriangulate2%29%29" data-pltdoc="x">Exercise&nbsp;384</a>, the solution calls for a generative recursive
function that creates a new matrix by shifting the first row to the end
when it encounters a <span class="RktVal">0</span> in the first position. Here is the solution:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">find the first row that doesn</span><span class="RktCmt">'</span><span class="RktCmt">t start with 0 and use it as the first one</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">generative</span><span class="RktCmt"> move the first row to last place </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">termination</span><span class="RktCmt"> this function does not terminate if all rows in </span><span class="RktSym">M</span><span class="RktCmt"> start with </span><span class="RktVal">0</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rotate-until.v2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29" class="RktValLink" data-pltdoc="x">append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Stop! Modify this function so that it signals an error when all rows start
with <span class="RktVal">0</span>.</div></p><p><div class="SIntrapara">If you measure this function on large instances of <a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a>, you get a
surprising result:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td align="right"><p>rows in <span class="RktSym">M</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>1000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>2000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>3000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>4000</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5000</p></td></tr><tr><td align="right"><p><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>17</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>66</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>151</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>272</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>436</p></td></tr></table></blockquote></div><div class="SIntrapara">As the number of rows increases from <span style="font-style: italic"></span>1<span style="font-style: italic">,</span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> to <span style="font-style: italic"></span>5<span style="font-style: italic">,</span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>, the time
spent by <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span> does not increase by a factor of five but by twenty.</div></p><p><div class="SIntrapara">The problem is that <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span> uses <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29" class="RktValLink" data-pltdoc="x">append</a></span>, which makes a
brand-new list like <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="stt"> </span><span class="RktSym">M</span><span class="RktPn">)</span> only to add <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="stt"> </span><span class="RktSym">M</span><span class="RktPn">)</span> at the
end. If <span class="RktSym">M</span> consists of <span style="font-style: italic"></span>1<span style="font-style: italic">,</span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span> rows and the last row is the
only one with a non-<span class="RktVal">0</span> coefficient, that&rsquo;s roughly
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_485.png" alt="image" width="164" height="13"/></p></blockquote></div><div class="SIntrapara">lists. How many lists do we get if <span class="RktSym">M</span> consists of <span style="font-style: italic"></span>5<span style="font-style: italic">,</span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>
lines?</div></p><p><div class="SIntrapara">Now suppose we conjecture that the accumulator-style version is
faster than the generative one. Here is the accumulator template assuming
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span> is a structurally recursive function:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> -&gt; </span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">find the first row that doesn</span><span class="RktCmt">'</span><span class="RktCmt">t start with 0 and use it as the first one</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rotate.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">M0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> ... -&gt; </span><a href="part_two.html#%28tech._matrix%29" class="techoutside" data-pltdoc="x"><span class="techinside">Matrix</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rotate/a</span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rotate/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">seen</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rotate%29%29" class="RktValLink" data-pltdoc="x">rotate</a></span><span class="hspace">&nbsp;</span><span class="RktSym">M0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The goal is to remember the first row when its leading coefficient is
<span class="RktVal">0</span> without using <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29" class="RktValLink" data-pltdoc="x">append</a></span> for every recursion.</div></p><p>Formulate an accumulator statement. Then follow the accumulator design
recipe to complete the above function. Measure how fast it runs on a
<span class="RktSym">Matrix</span> that consists of rows with leading <span class="RktVal">0</span>s except for
the last one. If you completed the design correctly, the function is quite fast. <img src="pict_486.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3ato10))"></a><span style="font-weight: bold">Exercise</span>&nbsp;416. Design <span class="RktSym">to10</span>. It consumes a list of digits and produces the
corresponding number. The first item on the list is the <span style="font-weight: bold">most significant</span>
digit. Hence, when applied to <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">0</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktVal">)</span>, it produces <span class="RktVal">102</span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">Domain Knowledge</span> You may recall from grade school that the result is determined by
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_487.png" alt="image" width="349" height="17"/></p></blockquote></div><div class="SIntrapara"><img src="pict_488.png" alt="image" width="3" height="10"/></div></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3ais-prime))"></a><span style="font-weight: bold">Exercise</span>&nbsp;417. Design the function <span class="RktSym">is-prime</span>, which consumes a
natural number and returns <span class="RktVal">#true</span> if it is prime and <span class="RktVal">#false</span>
otherwise.</p><p><span style="font-weight: bold">Domain Knowledge</span> A number <span style="font-style: italic">n</span> is prime if it is not divisible by any
number between <span style="font-style: italic">n - </span>1<span style="font-style: italic"></span> and <span style="font-style: italic"></span>2<span style="font-style: italic"></span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">Hint</span> The design recipe for <a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a> [&gt;=1] suggests the following template:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_two.html#%28tech._n%29" class="techoutside" data-pltdoc="x"><span class="techinside">N</span></a><span class="RktCmt"> [&gt;=1] -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determine whether </span><span class="RktSym">n</span><span class="RktCmt"> is a prime number</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-prime?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-prime?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This template immediately tells you that the function forgets <span class="RktSym">n</span>, its
initial argument as it recurs. Since <span class="RktSym">n</span> is definitely needed to determine
whether <span class="RktSym">n</span> is divisible by <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span>, <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">n</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span>, and so on,
you know that you need an accumulator-style function. <img src="pict_489.png" alt="image" width="3" height="10"/></div></p></blockquote><p><span style="font-weight: bold">Note on Speed</span> People who encounter accumulator-style programming for
the first time often get the impression that they are always faster than
their recursive counterparts. Both parts are plain wrong. While it is
impossible to explain this mistake in reasoning in this book, let us take a
look at the solution of <a href="part_six.html#%28counter._%28exercise._ex~3atime-factorial%29%29" data-pltdoc="x">exercise&nbsp;409</a>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td align="right"><p><span class="RktSym">!</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.760</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.780</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.800</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.820</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.870</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="highlighted"><span class="RktVal">5.806</span></span></p></td></tr><tr><td align="right"><p><span class="RktSym">!.v2</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.970</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.940</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.980</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>5.970</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p>6.690</p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td align="right"><p><span class="highlighted"><span class="RktVal">6.111</span></span></p></td></tr></table></blockquote><p>The table represents the timings for the two factorial functions. Specifically,
the top row shows the number of seconds for 1,000 evaluations of <span class="RktPn">(</span><span class="RktSym">!</span><span class="stt"> </span><span class="RktVal">20</span><span class="RktPn">)</span>
where the last cell shows the average. The bottom row shows the result of an
analogous experiment with <span class="RktSym">!.v2</span>. Bottom line is the performance of the
accumulator-style version of factorial is always worse than that of the original
factorial function.</p><h4>37.4<tt>&nbsp;</tt><a name="(part._accu-edit._sec~3aedit3)"></a>A Graphical Editor, with Mouse</h4><p><a href="part_one.html#%28part._sec~3aedit1%29" data-pltdoc="x">A Graphical Editor</a> introduces the notion of an one-liner editor and
presents a number of exercises on creating a graphical editor. An graphical
editor is an interactive program that interprets key events as editing
actions on a string. In particular, when a user presses the left or right
arrow key, the cursor moves left or right; similarly, pressing the delete
key removes a <a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> from the edited text.  The editor program uses
a data representation that combines two strings in a
structure. <a href="part_two.html#%28part._list-edit2._sec~3aedit2%29" data-pltdoc="x">A Graphical Editor, Revisited</a> resumes these
exercises and shows how the same program can greatly benefit from a
different data structure, one that combines two strings.</p><p>Neither of these sections deals with mouse actions for navigation, even
though all modern applications support this functionality. The basic
difficulty with mouse events is to place the cursor at the appropriate
spot. Since the program deals with a single line of text, a mouse click at
<span style="font-style: italic"></span>(<span style="font-style: italic">x,y</span>)<span style="font-style: italic"></span> clearly aims to place the cursor between the letters that are
visible at or around the <span style="font-style: italic">x</span> position. This section fills the gap.</p><p>Recall the relevant definitions from <a href="part_two.html#%28part._list-edit2._sec~3aedit2%29" data-pltdoc="x">A Graphical Editor, Revisited</a>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">FONT-SIZE</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">FONT-COLOR</span><span class="hspace">&nbsp;</span><span class="RktVal">"black"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a><span class="RktCmt">] -&gt; </span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">render a string as an image for the editor </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">editor-text</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29" class="RktValLink" data-pltdoc="x">implode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">FONT-SIZE</span><span class="hspace">&nbsp;</span><span class="RktSym">FONT-COLOR</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">editor</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">pre</span><span class="hspace">&nbsp;</span><span class="RktSym">post</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._accu-edit._editor)"></a><span style="font-style: italic">Editor</span><span class="RktCmt"> is </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-editor</span><span class="stt"> </span><span class="RktPn">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="stt"> </span><a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a><span class="RktPn">]</span><span class="stt"> </span><span class="RktPn">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="stt"> </span><a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> if </span><span class="RktPn">(</span><span class="RktSym">make-editor</span><span class="stt"> </span><span class="RktSym">p</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktCmt"> is the state of an</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">interactive editor, </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="stt"> </span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktCmt"> corresponds to the text to the</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">left of the cursor and </span><span class="RktSym">s</span><span class="RktCmt"> to the one on its right </span></td></tr></table></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._accu-edit._(exercise._ex~3aeditor-mouse-structural))"></a><span style="font-weight: bold">Exercise</span>&nbsp;418. Use the structural design recipe to
develop <span class="RktSym">split-structural</span>.  The function consumes a list of
<a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>s <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span> and a natural number <span class="RktSym">x</span>; the former
represents the complete string in some <a href="part_six.html#%28tech._accu-edit._editor%29" class="techoutside" data-pltdoc="x"><span class="techinside">Editor</span></a> and the latter the
<span style="font-style: italic">x</span> coordinate of the mouse click. It produces
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">make-editor</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">such that (1) <span class="RktSym">p</span> and <span class="RktSym">s</span> make up <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span> and (2) <span style="font-style: italic">x</span>
is larger than the image of <span class="RktSym">p</span> and smaller than the image of
<span class="RktSym">p</span> extended with the first <a href="part_one.html#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> on <span class="RktSym">s</span> (if any).</div></p><p><div class="SIntrapara">Here is the first condition expressed with an ISL+ expression:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">The second one is
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">editor-text</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">x</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">editor-text</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29" class="RktValLink" data-pltdoc="x">append</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">assuming <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span>.</div></p><p><span style="font-weight: bold">Hints</span> (1) The <span style="font-style: italic">x</span> coordinate measures the distance from the
left. Hence the function must check whether smaller and smaller prefixes of
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span> fit into the given width. The first one that doesn&rsquo;t corresponds
to the <span class="RktSym">pre</span> field of the desired <a href="part_six.html#%28tech._accu-edit._editor%29" class="techoutside" data-pltdoc="x"><span class="techinside">Editor</span></a>, the remainder of
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span> to the <span class="RktSym">post</span> field.</p><p>(2) Designing this function calls for thoroughly developing examples and
tests. See <a href="part_one.html#%28part._ch~3aintervals-enums%29" data-pltdoc="x">Intervals, Enumerations, Itemizations</a>. <img src="pict_490.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._accu-edit._(exercise._ex~3aeditor-mouse))"></a><span style="font-weight: bold">Exercise</span>&nbsp;419. Design the function <span class="RktSym">split</span>. Use the
accumulator design recipe to improve on the result of
<a href="part_six.html#%28counter._accu-edit._%28exercise._ex~3aeditor-mouse-structural%29%29" data-pltdoc="x">exercise&nbsp;418</a>. After all, the hints already point out
that when the function discovers the correct split point, it needs both
parts of the list and one part is obviously lost due to recursion. <img src="pict_491.png" alt="image" width="3" height="10"/></p></blockquote><p>Once you have solved this exercise, equip the <span class="RktSym">main</span> function of
<a href="part_two.html#%28part._list-edit2._sec~3aedit2%29" data-pltdoc="x">A Graphical Editor, Revisited</a> with a clause for mouse
clicks. As you experiment with moving the cursor via mouse clicks, you will
notice that it does not exactly behave like applications that you use on
your other devices&#8212;<wbr></wbr>even though <span class="RktSym">split</span> passes all its
tests.</p><p>Graphical programs, like editors, call for experimentation to come up with
best &ldquo;look and feel&rdquo; experiences. In this case, your editor is too
simplistic with its placement of the cursor. After the applications on your
computer determine the split point, they also determine which letter
division is closer to the <span style="font-style: italic">x</span> coordinate and place the cursor
there.</p><h3>38<tt>&nbsp;</tt><a name="(part._ch~3amore-accu)"></a>More Uses of Accumulation</h3><p>This chapter presents three more uses of accumulators. The first section
concerns the use of accumulators in conjunction with tree-processing
functions. It uses the compilation of ISL+ as an illustrative
example. The second section explains why we occasionally want accumulators
inside of data representations and how to go about it. The final section
resumes the discussion of rendering fractals.</p><h4>38.1<tt>&nbsp;</tt><a name="(part._sec~3amore-accu-trees)"></a>Accumulators and Trees</h4><p>When you ask DrRacket to run an ISL+ program, it translates the program to
commands for your specific computer.  This process is called
<span style="font-style: italic">compilation</span> and the part of DrRacket that performs the task is
called a <span style="font-style: italic">compiler</span>. Before the compiler translates the ISL+
program, it checks that every variable is declared via a <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>,
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span>, or a <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span>.</p><p>Stop! Enter <span class="RktSym">x</span>, <span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span>, and <span class="RktPn">(</span><span class="RktSym">x</span><span class="stt"> </span><span class="RktVal">5</span><span class="RktPn">)</span> as
completes ISL+ programs into DrRacket and ask it to run each. What do you
expect to see?</p><p><div class="SIntrapara">Let&rsquo;s phrase this idea as a sample problem:
</div><div class="SIntrapara"><blockquote><p><div class="SIntrapara"><span style="font-weight: bold">Sample Problem: </span>You have been hired to re-create a part of the ISL+
compiler. Specifically, your task deals with the following language
fragment, specified in the so-called grammar notation that many programming
language manuals use:<span class="refelem"><span class="refcolumn"><span class="refcontent">We use the Greek letter &#955; instead of
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span> to signal that this exercise deals with ISL+ as an
object of study not just a programming language.</span></span></span>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">expression</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">variable</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">variable</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">expression</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">expression</span><span class="hspace">&nbsp;</span><span class="RktVar">expression</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Remember from <a href="i1-2.html#%28part._sec~3asynsem~3agrammar%29" data-pltdoc="x">BSL: Grammar</a> that you can read the grammar
aloud replacing <span class="RktInBG"><span class="hspace"></span><span class="RktIn">=</span><span class="hspace"></span></span> with &ldquo;is one of&rdquo; and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">|</span><span class="hspace"></span></span> with &ldquo;or.&rdquo;</div></p><p>Recall that <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span> expressions are functions without names. They bind
their parameter in their body. Conversely, a variable occurrence is
declared by a surrounding <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span> that specifies the same name as a
parameter. You may wish to revisit <a href="i3-4.html" data-pltdoc="x">Intermezzo: Scope</a> because it deals with the
same issue from the perspective of a programmer. Look for the terms &ldquo;binding
occurrence,&rdquo; &ldquo;bound occurrence,&rdquo; and &ldquo;free.&rdquo;</p><p>Develop a data representation for the above language fragment; use symbols
to represent variables. Then design a function that replaces all undeclared
variables with <span class="RktVal">'</span><span class="RktVal">*undeclared</span>.</p></blockquote></div><div class="SIntrapara">This problem is representative of many steps in the translation process
and, at the same time, is a great case study for accumulator-style
functions.</div></p><p><div class="SIntrapara">Before we dive into the problem, let&rsquo;s look at some examples in this
mini-language, recalling what we know about <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span>:
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span> is the function that returns whatever it is given,
also known as the identity function;</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span> looks like a function that returns <span class="RktSym">y</span>
whenever it is given an argument, except that <span class="RktSym">y</span> isn&rsquo;t declared;</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span>  is a function that, when given some value
<span class="RktSym">v</span>, produces a function that always returns <span class="RktSym">v</span>;</p></li><li><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span> applies the identity function to itself;</p></li><li><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span> is a short infinite loop; and</p></li><li><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">z</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">z</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">w</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">w</span><span class="RktPn">)</span><span class="RktPn">)</span> is complex
expression that is best run in ISL+ to find out whether it even
terminates.</p></li></ul></div><div class="SIntrapara">Indeed, you can run all of the above ISL+ expression in DrRacket to confirm
what is written about them.</div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3abinding1))"></a><span style="font-weight: bold">Exercise</span>&nbsp;420. Explain the scope of each binding occurrence in
the above examples. Draw arrows from all bound occurrences to the binding
occurrences. <img src="pict_492.png" alt="image" width="3" height="10"/></p></blockquote><p><div class="SIntrapara">Developing a data representation for the language is easy, especially
because its description uses a grammar notation. Here is one possibility:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._lam)"></a><span style="font-style: italic">Lam</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> a </span><a href="i2-3.html#%28tech._symbol%29" class="techoutside" data-pltdoc="x"><span class="techinside">Symbol</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">&#955;</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><a href="i2-3.html#%28tech._symbol%29" class="techoutside" data-pltdoc="x"><span class="techinside">Symbol</span></a><span class="RktPn">)</span><span class="stt"> </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="stt"> </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Because of <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29" class="RktStxLink" data-pltdoc="x">quote</a></span>, this data representation makes it easy to
create data representations for expressions in our subset of ISL+:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex2</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex3</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex4</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="hspace">&nbsp;</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="hspace">&nbsp;</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">These four data examples are representations of some of the above
expressions. Stop! Create data representations for the remaining examples.</div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afree-bound-access))"></a><span style="font-weight: bold">Exercise</span>&nbsp;421. Define the functions <span class="RktSym">is-var?</span>,
<span class="RktSym">is-&#955;?</span>, and <span class="RktSym">is-app?</span>, predicates that distinguish
(representations of) variables from &#955; expressions and applications.</p><p><div class="SIntrapara">Also define
</div><div class="SIntrapara"><ul><li><p><span class="RktSym">&#955;-para</span>, which extracts the parameter from a &#955; expression;</p></li><li><p><span class="RktSym">&#955;-body</span>, which extracts the body from a &#955; expression;</p></li><li><p><span class="RktSym">app-fun</span>, which extracts the function from an application; and</p></li><li><p><span class="RktSym">app-arg</span>, which extracts the argument from an application.</p></li></ul></div><div class="SIntrapara">With these, you basically can act as if you had used a structure-oriented
data definition.</div></p><p>Design <span class="RktSym">declareds</span>, which produces the list of all symbols used as &#955;
parameters in a &#955; term. Don&rsquo;t worry about duplicate symbols. <img src="pict_493.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afree-bound-dd0))"></a><span style="font-weight: bold">Exercise</span>&nbsp;422. Develop a data representation for the same
subset of ISL+ that uses structures instead of lists. Also provide data
representations for <span class="RktSym">ex1</span>, <span class="RktSym">ex2</span>, and <span class="RktSym">ex3</span> following
you data definition. <img src="pict_494.png" alt="image" width="3" height="10"/></p></blockquote><p><div class="SIntrapara">We follow the structural design recipe, and here is the product of the
steps two and three:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> -&gt; </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">replace all symbols </span><span class="RktSym">s</span><span class="RktCmt"> in </span><span class="RktSym">le</span><span class="RktCmt"> with </span><span class="RktVal">'</span><span class="RktVal">*undeclared</span><span class="RktCmt"> if they do</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">not occur within the body of a &#955; whose parameter is </span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">*undeclared</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">le0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">le0</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Note how we expect <span class="RktSym">undeclareds</span> to process <span class="RktSym">ex4</span> even though
the expression loops forever when run; compilers don&rsquo;t run programs, they
read them and create others.</div></p><p><div class="SIntrapara">A close look at the purpose statement directly suggests that the function
needs an accumulator. This becomes even clearer when we inspect the
template for <span class="RktSym">undeclareds</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-var?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-&#955;?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#955;-body</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-app?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-fun</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-arg</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">When <span class="RktSym">undeclareds</span> recurs on the body of (the representation of) a &#955;
expression, it forgets <span class="RktPn">(</span><span class="RktSym">&#955;-para</span><span class="stt"> </span><span class="RktSym">le</span><span class="RktPn">)</span>, the declared variable.</div></p><p><div class="SIntrapara">So, let&rsquo;s start with an accumulator-style template:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">le0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> ??? -&gt; </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">a</span><span class="RktCmt"> represents ... </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-var?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-&#955;?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#955;-body</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-app?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-fun</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-arg</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktSym">le0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">In this context, we can now formulate an accumulator invariant:
</div><div class="SIntrapara"><blockquote><p><span class="RktSym">a</span> represents the list of &#955; parameters encountered on the path from
<span class="RktSym">le0</span> to <span class="RktSym">le</span>.</p></blockquote></div><div class="SIntrapara">For example, if <span class="RktSym">le0</span> is
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktVal">(</span></span><span class="highlighted"><span class="RktVal">&#955;</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktVal">(</span></span><span class="highlighted"><span class="RktVal">x</span></span><span class="highlighted"><span class="RktVal">)</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktVal">y</span></span><span class="highlighted"><span class="RktVal">)</span></span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">w</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">w</span><span class="RktVal">)</span><span class="RktVal">)</span></p></blockquote></div><div class="SIntrapara">and <span class="RktSym">le</span> is the highlighted subtree, then <span class="RktSym">a</span> contains
<span class="RktSym">y</span>. The left side of <a href="part_six.html#%28counter._%28figure._fig~3alam-tree%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">110</span></a> presents a graphical
illustration of the same example. It shows a <a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a> expression as an
upside-down tree, that is, the root is at the top. A <span class="stt">@</span> node represents
an application with two descendants; the other nodes are
self-explanatory. In this tree diagram, the bold path leads from
<span class="RktSym">le0</span> to <span class="RktSym">le</span> through a single variable declaration.</div></p><p><div class="SIntrapara">Similarly, if we pick a different subtree of the same piece of data,
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktVal">y</span></span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">w</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">w</span><span class="RktVal">)</span><span class="RktVal">)</span></p></blockquote></div><div class="SIntrapara">we get an accumulator that contains both <span class="RktVal">'</span><span class="RktVal">y</span> and <span class="RktVal">'</span><span class="RktVal">x</span>.
 The right side of <a href="part_six.html#%28counter._%28figure._fig~3alam-tree%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">110</span></a> makes this point again. Here
 the bold path leads through two <span class="RktVal">'</span><span class="RktVal">&#955;</span> nodes to the boxed subtree,
 and the accumulator is the list of declared variables along the bold
 path.</div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered"><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_495.png" alt="image" width="155.57250000000002" height="247.56"/> <span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_496.png" alt="image" width="151.53" height="247.56"/></p></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3alam-tree))" x-target-lift="Figure"></a>Figure&nbsp;110: </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a> terms as trees</span></p></blockquote><p><div class="SIntrapara">Now that we have settled on the data representation of the accumulator and
its invariant, we can resolve the remaining design questions:
</div><div class="SIntrapara"><ul><li><p>the initial accumulator value of <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span>;</p></li><li><p>we can use <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span> to add <span class="RktPn">(</span><span class="RktSym">&#955;-para</span><span class="stt"> </span><span class="RktSym">le</span><span class="RktPn">)</span> to <span class="RktSym">a</span>; and</p></li><li><p>once <span class="RktSym">undeclareds/a</span> reaches a variable, it can use the
accumulator to check whether the variable is in the scope of a declaration.</p></li></ul></div></p><p><a href="part_six.html#%28counter._%28figure._fig~3aundeclareds%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">111</span></a> shows how to translate these ideas into a
complete function definition. Note the name <span class="RktSym">declareds</span> for the
accumulator; it brings across the key idea behind the accumulator
invariant, helping the programmer understand the definition. The base case
uses <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span> from ISL+ to determine whether the variable
<span class="RktSym">le</span> is in <span class="RktSym">declareds</span> and, if not, replaces it with
<span class="RktVal">'</span><span class="RktVal">*undeclared</span>. The second <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clause uses a
<span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> to introduce the extended accumulator <span class="RktSym">newd</span>. Because
<span class="RktSym">para</span> is also used to rebuild the expression, it has its own
local definition. Finally, the last clause concerns function applications,
which do not declare variables and do not use any directly. As a result,
it is by far the simplest of the three clauses.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> -&gt; </span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">replace all symbols </span><span class="RktSym">s</span><span class="RktCmt"> in </span><span class="RktSym">le</span><span class="RktCmt"> with </span><span class="RktVal">'</span><span class="RktVal">*undeclared</span><span class="RktCmt"> if they do</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">not occur within the body of a &#955; whose parameter is </span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">*undeclared</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">ex4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ex4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds</span><span class="hspace">&nbsp;</span><span class="RktSym">le0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a><span class="RktCmt"> [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="i2-3.html#%28tech._symbol%29" class="techoutside" data-pltdoc="x"><span class="techinside">Symbol</span></a><span class="RktCmt">] -&gt; [</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="i2-3.html#%28tech._symbol%29" class="techoutside" data-pltdoc="x"><span class="techinside">Symbol</span></a><span class="RktCmt">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> </span><span class="RktSym">declareds</span><span class="RktCmt"> is a list of all &#955; </span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">parameters on the path from </span><span class="RktSym">le0</span><span class="RktCmt"> to </span><span class="RktSym">le</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="hspace">&nbsp;</span><span class="RktSym">declareds</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-var?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="hspace">&nbsp;</span><span class="RktSym">declareds</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">*undeclared</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-&#955;?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">para</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#955;-para</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">newd</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">para</span><span class="hspace">&nbsp;</span><span class="RktSym">declareds</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#955;-body</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">newd</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">para</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">is-app?</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-fun</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">declareds</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">app-arg</span><span class="hspace">&nbsp;</span><span class="RktSym">le</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">declareds</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">undeclareds/a</span><span class="hspace">&nbsp;</span><span class="RktSym">le0</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aundeclareds))" x-target-lift="Figure"></a>Figure&nbsp;111: </span>Finding undeclared variables</span></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afree-bound-both))"></a><span style="font-weight: bold">Exercise</span>&nbsp;423. Make up an ISL+ expression in which
<span class="RktSym">x</span> occurs both free and bound. Formulate it as an element of
<a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a>. Does <span class="RktSym">undeclareds</span> work properly on your expression? <img src="pict_497.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3afree-bound-undeclared))"></a><span style="font-weight: bold">Exercise</span>&nbsp;424. Considering the following expression:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*undeclared</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~ce~bb%29%29" class="RktStxLink" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">*undeclared</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Yes, it uses <span class="RktSym">*undeclared</span> as a variable. Represent it in <a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a>
and check what <span class="RktSym">undeclareds</span> produces for this expression.</div></p><p><div class="SIntrapara">Modify <span class="RktSym">undeclareds</span> so that it replaces each free occurrence of <span class="RktVal">'</span><span class="RktVal">x</span> with
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">*undeclared</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">x</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">and each bound one <span class="RktSym">y</span> with
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">*declared</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">y</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">Doing so unambiguously identifies problem spots, which a program-development
environment such as DrRacket can use to high-light errors.</div></p><p><span style="font-weight: bold">Note</span> The trick to replace a variable occurrence with the
representation of an application feels awkward. If you dislike it, consider
synthesizing the symbols <span class="RktVal">'</span><span class="RktVal">*undeclared:x</span> and <span class="RktVal">'</span><span class="RktVal">declared:y</span>
instead. <img src="pict_498.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afree-bound-dd1))"></a><span style="font-weight: bold">Exercise</span>&nbsp;425. Re-design the <span class="RktSym">undeclareds</span> function
for the structure-based data representation from
<a href="part_six.html#%28counter._%28exercise._ex~3afree-bound-dd0%29%29" data-pltdoc="x">exercise&nbsp;422</a>. <img src="pict_499.png" alt="image" width="3" height="10"/></p></blockquote><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered"><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_500.png" alt="image" width="208.70250000000001" height="321.975"/> <span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_501.png" alt="image" width="208.70250000000001" height="321.975"/></p></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3asd))" x-target-lift="Figure"></a>Figure&nbsp;112: </span>Static distances</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3afree-bound1))"></a><span style="font-weight: bold">Exercise</span>&nbsp;426. Design the function <span class="RktSym">static-distance</span>.
It replaces all occurrences of variables with a natural number that
represents how far away the declaring &#955; is.</p><p><div class="SIntrapara"><a href="part_six.html#%28counter._%28figure._fig~3asd%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">112</span></a> illustrates the idea. The tree on the left represents the
<a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a> term
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">y</span><span class="hspace">&nbsp;</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">&#955;</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">z</span><span class="RktVal">)</span><span class="RktVal">)</span></p></blockquote></div><div class="SIntrapara">in graphical form. It includes dotted arrows that point from variable
occurrences to the corresponding variable declarations. On the right, the
figure shows a tree of the same shape, though without the arrows. The
<span class="RktVal">'</span><span class="RktVal">&#955;</span> nodes come without names, and variable occurrences have been
replaced by natural numbers that specify which <span class="RktVal">'</span><span class="RktVal">&#955;</span> declares the
variable. Each natural number <span class="RktSym">n</span> says that the binding occurrence
is <span class="RktSym">n</span> steps upwards&#8212;<wbr></wbr>toward the root of the <a href="part_six.html#%28tech._lam%29" class="techoutside" data-pltdoc="x"><span class="techinside">Lam</span></a> tree. A
value of <span class="RktVal">0</span> denotes the first <span class="RktVal">'</span><span class="RktVal">&#955;</span> on the path to the root,
<span class="RktVal">1</span> the second one, and so on.</div></p><p><span style="font-weight: bold">Hint</span> The <span class="RktSym">undeclareds</span> accumulator of <span class="RktSym">undeclareds/a</span>
is a list of all parameters on path from <span class="RktSym">le</span> to <span class="RktSym">le0</span>
<span style="font-weight: bold">in reverse order</span>&#8212;<wbr></wbr>the last one seen is at the first on the list. <img src="pict_502.png" alt="image" width="3" height="10"/></p></blockquote></div></p><h4>38.2<tt>&nbsp;</tt><a name="(part._sec~3amore-accu-mc)"></a>Data Representations with Accumulators</h4><p>When you play board games or solve puzzles, you tend to think about your
 possible moves at every stage. As you get better, you may even imagine the
 possibilities after this first step. The result is a so-called
 <span style="font-style: italic">game tree</span>, which is a (part of the) tree of all possible moves
 that the rules allow.</p><p><div class="SIntrapara">Programs that generate and search such game trees are ubiquitous in the
world of computing:
</div><div class="SIntrapara"><blockquote><p><span style="font-weight: bold">Sample Problem: </span>Your manager tells you the following story.</p><p>&ldquo;Once upon a time, three cannibals were guiding three missionaries through a
 jungle. They were on their way to the nearest mission station. After some
 time, they arrived at a wide river, filled with deadly snakes and
 fish. There was no way to cross the river without a boat. Fortunately,
 they found a row boat with two oars after a short search. Unfortunately,
 the boat was too small to carry all of them. It could barely carry two
 people at a time.  Worse, because of the river&rsquo;s width someone had to
 row the boat back.</p><p>&ldquo;Since the missionaries could not trust the cannibals, they had to figure out
 a plan to get all six of them safely across the river. The problem was
 that these cannibals would kill and eat missionaries as soon as there were
 more cannibals than missionaries at some place. Thus our
 missionaries had to devise a plan that guaranteed that there were
 never any missionaries in the minority at either side of the river.  The
 cannibals, however, could be trusted to cooperate otherwise. Specifically,
 they wouldn&rsquo;t abandon any potential food, just as the missionaries
 wouldn&rsquo;t abandon any potential converts.&rdquo;</p><p>While your manager doesn&rsquo;t assign any specific design task, he wants to
 explore whether the company can design (and sell) programs that solve such
 puzzles.</p></blockquote></div><div class="SIntrapara">The point of this sample problem isn&rsquo;t just another form of tree, but an
 example of where accumulators are best merged with problem data rather
 than managed separately in a function.</div></p><p>In principle, it is quite straightforward to solve such puzzles by
hand. Here is the rough idea. Pick a graphical representation of the
problem states. Ours consists of a three-part box: the left one represents
the missionaries and the cannibals on the left; the middle combines the
river and the boat; and the third part is the right-hand side of the
river. Take a look at the following representation of the initial state:</p><p><div class="SIntrapara"><blockquote class="SCentered"><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_503.png" alt="image" width="114.24000000000001" height="49.56"/></p></blockquote></div><div class="SIntrapara">Black circles denote missionaries, white circles cannibals. All of them are
on the left-hand river bank. The boat is also on the left side. Nobody is
on the right. Here are two more states:</div></p><p><div class="SIntrapara"><blockquote class="SCentered"><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_504.png" alt="image" width="114.24000000000001" height="49.56"/> <span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_505.png" alt="image" width="114.24000000000001" height="49.56"/></p></blockquote></div><div class="SIntrapara">The first one is the final state, where all people and the boat are on the
right bank of the river. The second one depicts some intermediate state
where two people are on the left with the boat and four people are on the
right.</div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered"><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_506.png" alt="image" width="530.72" height="353.8"/></p></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3amc-transition))" x-target-lift="Figure"></a>Figure&nbsp;113: </span>Creating a game tree</span></p></blockquote><p>Now that you have a way to write down the state of the puzzle, you can
 think about the possibilities at each stage. Doing so yields a tree of
 possible moves. <a href="part_six.html#%28counter._%28figure._fig~3amc-transition%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">113</span></a> sketches the first two and
 a half layers in such a tree. The left-most state is the initial
 one. Because the boat can transport at most two people and must be rowed
 by at least one, you have five possibilities to explore: one cannibal rows
 across, two, one missionary and one cannibal go, one missionary, or two
 missionaries. These possibilities are represented with five arrows going
 from the initial state to five intermediate states.</p><p>For each of these five intermediate states, you can play the same game
 again. In <a href="part_six.html#%28counter._%28figure._fig~3amc-transition%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">113</span></a> you see how the game continues
 for the middle (third) one of the new states. Because there are only two
 people on the right river bank, you see three possibilities: a cannibal
 goes back, a missionary, or both. Hence three arrows connect the middle
 state to the three states on the right side of the tree.</p><p>If you keep drawing the tree of possibilities&#8212;<wbr></wbr>especially if you are doing
 it systematically&#8212;<wbr></wbr>you sooner or later discover the final state. That is,
 you create the final state with all people on the right river bank by
 moving a boat load of people from the left river bank to the right one,
 and nobody is left back.</p><p>A close look at <a href="part_six.html#%28counter._%28figure._fig~3amc-transition%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">113</span></a> reveals two problems with
 this naive approach to generating the tree of possibilities. The first one
 is the dashed arrow that connects the middle state on the right to the
 initial state. It indicates that rowing back the two people from the right
 to the left gets the puzzle back to its initial state, meaning you&rsquo;re
 starting over, which is obviously undesirable. The second problem concerns
 those states with a star in the top-right corner. In both cases, there are
 more white-circle cannibals than black-circle missionaries on the left
 river bank, meaning the cannibals would eat the missionaries. Again, the
 goal is to avoid such states, making these moves undesirable.</p><p><div class="SIntrapara">One way to turn this puzzle into a program is to design a function that
 determines whether some final state&#8212;<wbr></wbr>here <span style="font-weight: bold">the</span> final state&#8212;<wbr></wbr>is
 reachable from some given state. Here is an appropriate function
 definition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a><span class="RktCmt"> -&gt; </span><a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determine whether the final state is reachable from the given state</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">generative</span><span class="RktCmt"> create search tree of possible boat rides </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">termination ???</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">solve</span><span class="hspace">&nbsp;</span><span class="RktSym">initial-puzzle</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">final-puzzle</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">solve</span><span class="hspace">&nbsp;</span><span class="RktSym">state0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">[</span><a href="part_three.html#%28tech._sim-dd._list._of%29" class="techoutside" data-pltdoc="x"><span class="techinside">List-of</span></a><span class="RktCmt"> </span><a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a><span class="RktCmt">] -&gt; </span><a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">generative</span><span class="RktCmt"> generate the successor states for all intermediate ones</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">solve*</span><span class="hspace">&nbsp;</span><span class="RktSym">los</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._ormap%29%29" class="RktValLink" data-pltdoc="x">ormap</a></span><span class="hspace">&nbsp;</span><span class="RktSym">final?</span><span class="hspace">&nbsp;</span><span class="RktSym">los</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktSym">final?</span><span class="hspace">&nbsp;</span><span class="RktSym">los</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">solve*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">create-next-states</span><span class="hspace">&nbsp;</span><span class="RktSym">los</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">solve*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">state0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The auxiliary function uses generative recursion, generating all new
 possibilities given a list of possibilities. If one of the given
 possibilities is a final state, the function returns it.</div></p><p>Clearly, <span class="RktSym">solve</span> is quite generic. As long as you define a
 collection of <a name="(tech._puzzlestate)"></a><span style="font-style: italic">PuzzleState</span>s, a function for recognizing final
 states, and a function for creating all &ldquo;successor&rdquo; states,
 <span class="RktSym">solve</span> can work on your puzzle.</p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3amc-terminates))"></a><span style="font-weight: bold">Exercise</span>&nbsp;427. The <span class="RktSym">solve*</span> function generates all
 states reachable with <span style="font-style: italic">n</span> boat trips before it looks at states that
 require <span style="font-style: italic">n + </span>1<span style="font-style: italic"></span> boat trips, even if some of those boat trips return
 to previously encountered states. Because of this systematic way of
 traversing the tree, <span class="RktSym">solve*</span> cannot go into an infinite loop. Why?</p><p><span style="font-weight: bold">Terminology</span> This way of searching a tree or a graph is dubbed
<span style="font-style: italic">breadth-first search</span>. <img src="pict_507.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3amc-state))"></a><span style="font-weight: bold">Exercise</span>&nbsp;428. Develop a data representation for the states of
 the missionary-and-cannibal puzzle. Like the graphical representation, a
 state must obviously record the number of missionaries and cannibals on
 each side of the river plus the location of the boat. After all, these are
 the properties of the world that change with one boat trip.</p><p>The description of <a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a>s calls for a structure type
 definition. Represent the above initial, intermediate, and final states in
 your chosen data representation.</p><p>Design the function <span class="RktSym">final?</span>, which detects whether in a given state
 all people are on the right river bank.</p><p>Design the function <span class="RktSym">render-mc</span>, which maps a state of the
 missionary-and-cannibal puzzle to an image. <img src="pict_508.png" alt="image" width="3" height="10"/></p></blockquote><p>The problem is that returning the final state says nothing about how the
 player can get from the initial state to the final one. In other words,
 <span class="RktSym">create-next-states</span> forgets how it gets to the returned states
 from the given ones. And this situation clearly calls for an accumulator,
 but at the same time, the accumulated knowledge is best associated with
 the individual <a href="part_six.html#%28tech._puzzlestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">PuzzleState</span></a>s not <span class="RktSym">solve*</span> or any other
 function.</p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3amc-accu-state))"></a><span style="font-weight: bold">Exercise</span>&nbsp;429. Modify the data representation from
 <a href="part_six.html#%28counter._%28exercise._ex~3amc-state%29%29" data-pltdoc="x">exercise&nbsp;428</a> so that each state records the sequence of states
 traversed to get there. Use a list of states.</p><p>Articulate and write down an accumulator statement with the data definition
 that explains the additional field.</p><p>Do you have to modify <span class="RktSym">final?</span> or <span class="RktSym">render-mc</span> to work on this
 revised data representation? <img src="pict_509.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3amc-next-state))"></a><span style="font-weight: bold">Exercise</span>&nbsp;430. Design the <span class="RktSym">create-next-states</span>
 function. It consumes lists of missionary-and-cannibal states and
 generates the list of all those states that a boat ride can reach.</p><p>Ignore the accumulator in the first draft of <span class="RktSym">create-next-states</span>,
 but make sure that the function does not generate states where the
 cannibals can eat the missionaries.</p><p>For the second design, update the accumulator field in the state structures
 and use it to rule out states that have been encountered on the way to the
 current state. <img src="pict_510.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3amc-solve))"></a><span style="font-weight: bold">Exercise</span>&nbsp;431. Exploit the accumulator-oriented data
representation to modify <span class="RktSym">solve</span>. The revised function produces the
list of states that lead from the initial puzzle state to the final one.</p><p>Also consider creating a movie from this list, using <span class="RktSym">render-mc</span> to
generate the images. Use <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpuniverse.html#%28def._%28%28lib._2htdp%2Funiverse..rkt%29._run-movie%29%29" class="RktValLink" data-pltdoc="x">run-movie</a></span> to display the movie. <img src="pict_511.png" alt="image" width="3" height="10"/></p></blockquote><h4>38.3<tt>&nbsp;</tt><a name="(part._sec~3afractal-acc)"></a>Accumulators as Results</h4><p><div class="SIntrapara">Take a second look at <a href="part_five.html#%28counter._%28figure._fig~3asierpinski-code%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">85</span></a>. It displays a
Sierpinski triangle and a suggestion how to create such a
fractal. Specifically, the images on the right explain one version of the
generative idea behind the process of generating a Sierpinski triangle:
</div><div class="SIntrapara"><blockquote><p>The given problem is a triangle. When
the triangle is too small to be sub-divided any further, the algorithm does
nothing; otherwise, it finds the midpoints of its three sides and deals
with the three outer triangles recursively.</p></blockquote></div><div class="SIntrapara">In contrast, <a href="part_five.html#%28part._sec~3afractal%29" data-pltdoc="x">Fractals, a First Taste</a> shows how to compose Sierpinski triangles
algebraically, a process that does not correspond to this description.</div></p><p><div class="SIntrapara">Most programmers expect the word &ldquo;draw&rdquo; to mean the action of adding a
triangle to some canvas. The <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._scene%2Bline%29%29" class="RktValLink" data-pltdoc="x">scene+line</a></span> function from
<span class="sroman">the <span class="stt">"image"</span> library</span> make this idea concrete. The function consumes an image
<span class="RktSym">s</span> and the coordinates of two points and adds a line through these
two points to <span class="RktSym">s</span>. It is easy to generalize from <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._scene%2Bline%29%29" class="RktValLink" data-pltdoc="x">scene+line</a></span>
to <span class="RktSym">add-triangle</span> and from there to <span class="RktSym">add-sierpinski</span>:
</div><div class="SIntrapara"><blockquote><p><span style="font-weight: bold">Sample Problem: </span>Design the <span class="RktSym">add-sierpinski</span> function. It consumes an
image and three <a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>s describing an triangle. It adds to
this given image a Sierpinski triangle whose outer perimeter is the given
triangle.</p></blockquote></div><div class="SIntrapara">Note how this sample problem implicitly refers to the above process
description of how to draw a Sierpinski triangle. In other words, we are
confronted with a classical generative-recursive problem and we can start
with the classic template of generative recursion and the four central
design questions:
</div><div class="SIntrapara"><ul><li><p>The given problem is trivial if the triangle is too small to be
subdivided.</p></li><li><p>In the trivial case, the function returns the given image.</p></li><li><p>Otherwise the process adds the triangle and determines the midpoints
of the given triangle&rsquo;s sides. Each &ldquo;outer&rdquo; triangle is then processed
recursively.</p></li><li><p>Each of these recursive steps produces an image. The remaining
question is how to combine these images.</p></li></ul></div></p><p><div class="SIntrapara">It is straightforward to translate these answers into a skeletal ISL+
definition:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">generative</span><span class="RktCmt"> adds the triangle (</span><span class="RktSym">a</span><span class="RktCmt">, </span><span class="RktSym">b</span><span class="RktCmt">, </span><span class="RktSym">c</span><span class="RktCmt">) to </span><span class="RktSym">s</span><span class="RktCmt">, subdivides the triangle </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">into three by taking the midpoints of its sides, and deals</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">with the outer triangles recursively until it is too small</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">too-small?</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-triangle</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene4</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene1</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene2</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene3</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Since each midpoint is used twice, the skeleton use a <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span>
expression to formulate the generative step in ISL+. The <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span>
expression introduces the three new midpoints plus three recursive
applications of <span class="RktSym">sierpinski</span>. The dots in its body suggests a
combination of the scenes.</div></p><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3asierpinski-aux))"></a><span style="font-weight: bold">Exercise</span>&nbsp;432. In the meantime, we can tackle the wish list
that implicitly comes with the above skeleton:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">add the black triangle </span><span class="RktSym">a</span><span class="RktCmt">, </span><span class="RktSym">b</span><span class="RktCmt">, </span><span class="RktSym">c</span><span class="RktCmt"> to </span><span class="RktSym">scene</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-triangle</span><span class="hspace">&nbsp;</span><span class="RktSym">scene</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">scene</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is the triangle </span><span class="RktSym">a</span><span class="RktCmt">, </span><span class="RktSym">b</span><span class="RktCmt">, </span><span class="RktSym">c</span><span class="RktCmt"> too small tp be divided further</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">too-small?</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determine the midpoint between </span><span class="RktSym">a</span><span class="RktCmt"> and </span><span class="RktSym">b</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Design the three functions.</div></p><p><div class="SIntrapara"><span style="font-weight: bold">Domain Knowledge</span> (1) For the <span class="RktSym">too-small?</span> function it suffices to
measure the distance between two points and to check whether it is below
some chosen threshold, say, <span class="RktVal">10</span>. The distance between
<span style="font-style: italic"></span>(<span style="font-style: italic">x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic">,y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> and <span style="font-style: italic"></span>(<span style="font-style: italic">x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic">,y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> is
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_512.png" alt="image" width="159" height="18"/></p></blockquote></div><div class="SIntrapara">that is, the distance of <span style="font-style: italic"></span>(<span style="font-style: italic">x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"> - y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic">,x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"> - y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> to the origin.</div></p><p><div class="SIntrapara">The midpoint between points <span style="font-style: italic"></span>(<span style="font-style: italic">x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic">,y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> and <span style="font-style: italic"></span>(<span style="font-style: italic">x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic">,y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> is
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_513.png" alt="image" width="136" height="31"/></p></blockquote></div><div class="SIntrapara">that is, its coordinates are the midpoints between each pair of
coordinates, respectively. <img src="pict_514.png" alt="image" width="3" height="10"/></div></p></blockquote><p>Now that we have all the auxiliary functions, it is time to return to the problem
of combining the three images that are created by the recursive calls. One obvious
guess is to use the <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span> or <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._underlay%29%29" class="RktValLink" data-pltdoc="x">underlay</a></span> function, but a test at
in the interaction area of DrRacket shows that the functions hide the underlying
triangles.</p><p><div class="SIntrapara">Specifically imagine that the three recursive calls produce the following empty
scenes enriched with a single triangle in appropriate locations:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktSym">scene1</span></td></tr><tr><td><p><img src="pict_515.png" alt="image" width="51" height="31"/></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">scene2</span></td></tr><tr><td><p><img src="pict_516.png" alt="image" width="51" height="31"/></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">scene3</span></td></tr><tr><td><p><img src="pict_517.png" alt="image" width="51" height="31"/></p></td></tr></table></blockquote></div><div class="SIntrapara">A combination should look like this figure:
</div><div class="SIntrapara"><blockquote><p><img src="pict_518.png" alt="image" width="50" height="30"/></p></blockquote></div><div class="SIntrapara">But, combining these shapes with <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span> or <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._underlay%29%29" class="RktValLink" data-pltdoc="x">underlay</a></span>
does not yield this desired shape:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene1</span><span class="hspace">&nbsp;</span><span class="RktSym">scene2</span><span class="hspace">&nbsp;</span><span class="RktSym">scene3</span><span class="RktPn">)</span></td></tr><tr><td><p><img src="pict_519.png" alt="image" width="51" height="31"/></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._underlay%29%29" class="RktValLink" data-pltdoc="x">underlay</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene1</span><span class="hspace">&nbsp;</span><span class="RktSym">scene2</span><span class="hspace">&nbsp;</span><span class="RktSym">scene3</span><span class="RktPn">)</span></td></tr><tr><td><p><img src="pict_520.png" alt="image" width="51" height="31"/></p></td></tr></table></blockquote></div><div class="SIntrapara">Indeed, the image library of ISL+ does not support a function that
combines these scenes in an appropriate manner.</div></p><p><div class="SIntrapara">Let&rsquo;s take a second look at these interactions. If <span class="RktSym">scene1</span> is the
result of adding the upper triangle to the given scene and <span class="RktSym">scene2</span>
is the result of adding a triangle on the lower left, perhaps the second
recursive call should add triangles to the result of the first call. Doing
so would yield
</div><div class="SIntrapara"><blockquote><p><img src="pict_521.png" alt="image" width="50" height="30"/></p></blockquote></div><div class="SIntrapara">and handing over this scene to the third recursive call produces exactly
what is wanted:
</div><div class="SIntrapara"><blockquote><p><img src="pict_522.png" alt="image" width="50" height="30"/></p></blockquote></div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">generative</span><span class="RktCmt"> adds the triangle (</span><span class="RktSym">a</span><span class="RktCmt">, </span><span class="RktSym">b</span><span class="RktCmt">, </span><span class="RktSym">c</span><span class="RktCmt">) to </span><span class="RktSym">s</span><span class="RktCmt">, subdivides the triangle </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">into three by taking the midpoints of its sides, and deals</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">with the outer triangles recursively until it is too small</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">accumulator</span><span class="RktCmt"> the function accumulates the triangles in the given scene </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">too-small?</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-triangle</span><span class="hspace">&nbsp;</span><span class="RktSym">scene0</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mid-point</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym">scene1</span></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym">scene2</span></span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-a-b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktSym">scene3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-c-a</span><span class="hspace">&nbsp;</span><span class="RktSym">mid-b-c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aadd-sierpinski))" x-target-lift="Figure"></a>Figure&nbsp;114: </span>Adding Sierpinski triangles to an image</span></p></blockquote><p><a href="part_six.html#%28counter._%28figure._fig~3aadd-sierpinski%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">114</span></a> shows the reformulation based on this insight.
The three highlights pinpoint the key design idea. All concern the case
when the triangle is sufficiently large and it is added to the given scene.
Once its sides are sub-divided, the first outer triangle is recursively
processed using <span class="RktSym">scene1</span>, the result of adding the given
triangle. Similarly, the result of this first recursion, dubbed
<span class="RktSym">scene2</span>, is used for the second recursion, which is about
processing the second triangle. Finally, <span class="RktSym">scene3</span> flows into the
third recursive call. In sum, the novelty is that the accumulator is
simultaneously an argument, a medium for collecting knowledge, and the
result of the function.</p><p><div class="SIntrapara">To explore <span class="RktSym">add-sierpinski</span> it is best to start from an equilateral
triangle and an image that leaves a sufficiently large border. Here are
definitions that meet these two criteria:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">400</span><span class="hspace">&nbsp;</span><span class="RktVal">400</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">B</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">27</span><span class="hspace">&nbsp;</span><span class="RktVal">350</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">C</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">373</span><span class="hspace">&nbsp;</span><span class="RktVal">350</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Check what kind of Sierpinski fractal <span class="RktPn">(</span><span class="RktSym">add-sierpinski</span><span class="stt"> </span><span class="RktSym">MT</span><span class="stt"> </span><span class="RktSym">A</span><span class="stt"> </span><span class="RktSym">B</span><span class="stt"> </span><span class="RktSym">C</span><span class="RktPn">)</span>
delivers. Experiment with the definitions from <a href="part_six.html#%28counter._%28exercise._ex~3asierpinski-aux%29%29" data-pltdoc="x">exercise&nbsp;432</a> to
create sparser and denser Sierpinski triangles than the first one.</div></p><blockquote class="SubFlow"><p><a name="(counter._(exercise._ex~3asierpinski-start))"></a><span style="font-weight: bold">Exercise</span>&nbsp;433. To compute the endpoints of an equilateral
Sierpinski triangle, draw a circle and pick three points on the circle that
are 120 degrees apart, for example, 120, 240, and 360.</p><p><div class="SIntrapara">Design the function <span class="RktSym">circle-pt</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="part_one.html#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determines the point on the circle with </span><span class="RktSym">CENTER</span><span class="RktCmt"> and</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">RADIUS</span><span class="RktCmt"> whose angle is </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">examples</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 120/360, what are the </span><span style="font-style: italic">x</span><span class="RktCmt"> and </span><span style="font-style: italic">y</span><span class="RktCmt"> coordinates of the desired point </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 240/360, what are the </span><span style="font-style: italic">x</span><span class="RktCmt"> and </span><span style="font-style: italic">y</span><span class="RktCmt"> coordinates of the desired point </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 360/360, what are the </span><span style="font-style: italic">x</span><span class="RktCmt"> and </span><span style="font-style: italic">y</span><span class="RktCmt"> coordinates of the desired point </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">circle-pt</span><span class="hspace">&nbsp;</span><span class="RktSym">factor</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><span style="font-weight: bold">Domain Knowledge</span> This design problem calls on knowledge from
  mathematics. One way to view the problem is as a conversion of a complex
  number from the polar-coordinate representation to the <a href="part_one.html#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>
  representation. Read up on <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-polar%29%29" class="RktValLink" data-pltdoc="x">make-polar</a></span>, <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._real-part%29%29" class="RktValLink" data-pltdoc="x">real-part</a></span>, and
  <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._imag-part%29%29" class="RktValLink" data-pltdoc="x">imag-part</a></span> in ISL+. Another way is to use trigonometry,
  <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sin%29%29" class="RktValLink" data-pltdoc="x">sin</a></span> and <span class="RktSym"><a href="http://plt.eecs.northwestern.edu/snapshots/current/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cos%29%29" class="RktValLink" data-pltdoc="x">cos</a></span>, to determine the coordinates. If you
  choose this route, recall that these trigonometry functions
  compute the sine and cosine in terms of radians, not degrees. Also keep
  in mind that on-screen positions grow downwards not upwards. <img src="pict_523.png" alt="image" width="3" height="10"/></div></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3atree-generation))"></a><span style="font-weight: bold">Exercise</span>&nbsp;434. Take a look at the following two images:
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_524.png" alt="image" width="132" height="132"/>
<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<img src="pict_525.png" alt="image" width="132" height="132"/></p></blockquote></div><div class="SIntrapara">They demonstrate how to generate a fractal Savannah tree in the same way that
<a href="part_five.html#%28counter._%28figure._fig~3asiepic%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">84</span></a> shows how to draw a Sierpinski triangle. The
image on the left shows what a fractal Savannah tree looks like. The right
one explains the generative construction step.</div></p><p>Design the function <span class="RktSym">add-savannah</span>. The function consumes an image
and four numbers: (1) the <span style="font-style: italic">x</span> coordinate of a line&rsquo;s base point, (2)
the <span style="font-style: italic">y</span> coordinate of a line&rsquo;s base point, (3) the length of the line,
and (4) the angle of the line. It adds a fractal Savannah tree to the given
image.</p><p>Unless the line is too short, the function adds the specified line to the
image. It then divides the line into three segments. It recursively uses
the two intermediate points as the new starting points for two lines. The
lengths and the angles of the two branches change in a fixed manner, but
independently of each other. Use constants to define these changes and work
with them until you like your tree well enough.</p><p><span style="font-weight: bold">Hint</span> Experiment with shortening the left branches by at least one
third and rotating it left by at least <span class="RktVal">0.15</span> degrees. For the right
branch, shorten it by at least 20% and rotate it by <span class="RktVal">0.2</span> degrees in
the opposite direction. <img src="pict_526.png" alt="image" width="3" height="10"/></p></blockquote><blockquote class="SubFlow"><p><div class="SIntrapara"><a name="(counter._(exercise._ex~3abezier))"></a><span style="font-weight: bold">Exercise</span>&nbsp;435. Graphics programmers often need to connect two
 points with a smooth curve where &ldquo;smooth&rdquo; is relative to some
 perspective. Take a look at these two images:
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_527.png" alt="image" width="132" height="132"/>
<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<img src="pict_528.png" alt="image" width="132" height="132"/></p></blockquote></div><div class="SIntrapara">The left one shows a smooth curve, connecting points <span style="font-style: italic">A</span> and
 <span style="font-style: italic">C</span>; the right one supplies the perspective point, <span style="font-style: italic">B</span>, and the
 angle that an observer would have from this point.</div></p><p><div class="SIntrapara">One method for drawing such curves is due to B&#233;zier.<span class="refelem"><span class="refcolumn"><span class="refcontent">Dr.
G&#233;raldine Morin suggested this exercise.</span></span></span> It is a prime example of
 generative recursion, and the following sequence explains the
 <span style="font-style: italic">eureka!</span> behind the algorithm:
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="pict_529.png" alt="image" width="132" height="132"/>
<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<img src="pict_530.png" alt="image" width="132" height="132"/>
<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<img src="pict_531.png" alt="image" width="132" height="132"/></p></blockquote></div><div class="SIntrapara">Consider the image on the left. It reminds you that the three given points determine a
 triangle and that the connection between <span style="font-style: italic">A</span> to <span style="font-style: italic">C</span> is the focal
 point of the algorithm.  The goal is to pull the line from <span style="font-style: italic">A</span> to
 <span style="font-style: italic">C</span> toward <span style="font-style: italic">B</span> so that it turns into a smooth curve.</div></p><p>Now turn to the image in the middle It explains the essential idea of the
 generative step. The algorithm determines the midpoint on the two observer
 lines, <span style="font-style: italic">A-B</span> and <span style="font-style: italic">B-C</span>, as well as the midpoint between these
 two, <span style="font-style: italic">A-B-C</span>.</p><p>Finally, the rightmost image shows how these three new points generate
 two distinct recursive calls: one deals with the new triangle on the left
 and the other one with the triangle on the right. More precisely,
 <span style="font-style: italic">A-B</span> and <span style="font-style: italic">B-C</span> become the new observer points and the lines
 from <span style="font-style: italic">A</span> to <span style="font-style: italic">A-B-C</span> and from <span style="font-style: italic">C</span> to <span style="font-style: italic">A-B-C</span> become the
 foci of the two recursive calls.</p><p>When the triangle is small enough, we have a trivially solvable case. The
 algorithm just draws the triangle, and it appears as a point on the given
 image. You may need to experiment with the notion of &ldquo;small enough&rdquo; to
 make the curve look smooth. <img src="pict_532.png" alt="image" width="3" height="10"/></p></blockquote><h3>39<tt>&nbsp;</tt><a name="(part._ch~3asummary6)"></a>Summary</h3><p><div class="SIntrapara">This sixth and last part of the book is about designing with accumulators, a
mechanism for collecting knowledge during a data structure traversal. Adding an
accumulator may fix performance flaws, and for algorithms, it may eliminate
termination problems.  Your take-away from this part are two and a half design
lessons:
</div><div class="SIntrapara"><ol><li><p>The first step is to recognize the need for introducing an
accumulator. Traversals &ldquo;forget&rdquo; pieces of the argument when
they step from piece to the next. If you discover that such knowledge could simplify the
function&rsquo;s design, consider introducing an accumulator. The first step is
to switch to the <span style="font-weight: bold">accumulator template</span>.</p></li><li><p>The second, and key, step is to formulate an accumulator
statement. Concisely put, the statement must express <span style="font-weight: bold">what knowledge</span>
the accumulator gathers <span style="font-weight: bold">using what kind of data</span>. Don&rsquo;t proceed until
you have answered these questions. In most cases, the accumulator statement
describes the relevant difference between the very original argument and the
current argument.</p></li><li><p>The third step, a minor one, is to deduce from the accumulator
statement (1) what the initial accumulator value is, (2) how to maintain it
during traversal steps, and (3) how to exploit its knowledge.</p></li></ol></div></p><p>The idea of accumulating knowledge is ubiquitous, and it appears in many
different forms and shapes. It is widely used in so-called functional
languages like ISL+. Programmers using imperative languages encounter
accumulators in a different way, mostly via assignment statements in primitive
looping constructs, because the latter cannot return values. Designing such
imperative accumulator programs proceeds just like the design of accumulator
functions here, but the details are beyond the scope of this first book on
systematic program design.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="i5-6.html" title="backward to &quot;Intermezzo: Vectors&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;How to Design Programs, Second Edition&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="htdp2e-epilogue.html" title="forward to &quot;Epilogue&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>