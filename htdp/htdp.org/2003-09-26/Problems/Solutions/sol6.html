<html><head><title>HtDP Solution Set</title></head><body bgcolor="white"><br /><table width="100%"><tr><td align="left"><h3>HtDP Solution Set</h3></td><td align="right"><h3>Section 6</h3></td></tr></table><pre><br /></pre><p><hr /><a name="PROBLEM1"><font color="red">Problem 1 (Solution): </font></a><blockquote><pre>;area-of-circle: Posn Posn -&gt; Number<br />; - given the center and point on circumference, return the area<br />;   enclosed by circle<br />(define (area-of-circle c p)<br />  (* pi (sqr (seg-length c p))))<br />&nbsp;<br />;seg-length: Posn Posn -&gt; Number<br />; - compute distance between two points<br />(define (seg-length p1 p2)<br />  (sqrt (+ (sqr (- (posn-x p1) (posn-x p2)))<br />	   (sqr (- (posn-y p1) (posn-y p2))))))<br />&nbsp;<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(seg-length (make-posn 0 0) (make-posn 1 1))<br />"should be" (sqrt 2)<br />&nbsp;<br />(seg-length (make-posn -3 -2) (make-posn 0 2))<br />"should be" 5<br />&nbsp;<br />(area-of-circle (make-posn 0 0) (make-posn 1 1))<br />"should be" (* 2 pi)<br />(area-of-circle (make-posn 1 2) (make-posn 3 4))<br />"should be" (* 8 pi)<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM2"><font color="red">Problem 2 (Solution): </font></a><blockquote><pre>; A Paycheck is a structure<br />;  (make-paycheck Number Symbol Symbol Number)<br />&nbsp;<br />(define-struct paycheck (cnum name date amount))<br />&nbsp;<br />;create-paycheck: Number Symbol Symbol Number Number Number -&gt; Paycheck<br />(define (create-paycheck cnum name date hours wage taxrate)<br />  (make-paycheck cnum name date<br />		 (* hours wage (- 1.00 taxrate))))<br />&nbsp;<br />#| Tests |#<br />(create-paycheck 1001 'Allen 'Feb-5-2002 40 16 .25)<br />"should be" (make-paycheck 1001 'Allen 'Feb-5-2002 480.0)<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM3"><font color="red">Problem 3 (Solution): </font></a><blockquote><pre>;A Score is structure<br />;  (make-score Symbol Number)<br />&nbsp;<br />(define-struct score (name points))<br />&nbsp;<br />;outcome: Score Score -&gt; Symbol <br />;  - given the scores from a game, <br />;    return the name of the winner or 'Tie<br />(define (outcome s1 s2)<br />  (cond<br />   [(&gt; (score-points s1) (score-points s2))<br />    (score-name s1)]<br />   [(&lt; (score-points s1) (score-points s2))<br />    (score-name s2)]<br />   [else 'Tie]))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(outcome (make-score 'Bears 20) (make-score 'Eagles 30))<br />"should be" 'Eagles<br />(outcome (make-score 'Raven 10) (make-score 'Cubs 10))<br />"should be" 'Tie<br />(outcome (make-score 'Jen 8) (make-score 'April 5))<br />"should be" 'Jen<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM4"><font color="red">Problem 4 (Solution): </font></a><blockquote><pre>;An Entry is a structure<br />;  (make-entry Number Symbol Number Symbol)<br />&nbsp;<br />(define-struct entry (item bidder amount status))<br />&nbsp;<br />&nbsp;<br />;new-bid: Symbol Number Entry -&gt; Entry<br />; - return the resulting entry of a new auction bid<br />(define (new-bid a-bidder a-bid an-entry)<br />  (cond<br />   [(symbol=? (entry-status an-entry) 'Closed) an-entry]<br />   [(&lt; a-bid (entry-amount an-entry)) an-entry]<br />   [else<br />    (make-entry (entry-item an-entry)<br />		a-bidder <br />		a-bid<br />		(entry-status an-entry))]))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(new-bid 'Bbidder 60 (make-entry 4004 'Abidder 50 'Open))<br />"should be" (make-entry 4004 'Bbidder 60 'Open)<br />&nbsp;<br />(new-bid 'Bbidder 60 (make-entry 4004 'Abidder 50 'Closed))<br />"should be" (make-entry 4004 'Abidder 50 'Closed)<br />&nbsp;<br />(new-bid 'Bbidder 40 (make-entry 4004 'Abidder 50 'Closed))<br />"should be" (make-entry 4004 'Abidder 50 'Closed)<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM5"><font color="red">Problem 5 (Solution): </font></a><blockquote><pre>;An Icecube is a structure<br />;  (make-icecube Number Number)<br />&nbsp;<br />(define-struct Icecube (mass velocity))<br />&nbsp;<br />;collision-result: Icecube Icecube -&gt; Icecube<br />;  return Icecube after collision<br />(define (collision-result sc1 sc2)<br />  (make-icecube<br />    (+ (icecube-mass sc1)<br />       (icecube-mass sc2))<br />    (/ (+ (momentum sc1) (momentum sc2))<br />       (+ (icecube-mass sc1)<br />	  (icecube-mass sc2)))))<br />&nbsp;<br />;momentum: Icecube -&gt; Number<br />;  calculate the momentum of a cube<br />(define (momentum sc)<br />  (* (icecube-mass sc)<br />     (icecube-velocity sc)))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(momentum (make-icecube 2 3))<br />"should be" 6<br />&nbsp;<br />(collision-result (make-icecube 3 3) (make-icecube 3 -3))<br />"should be" (make-icecube 6 0)<br />(collision-result (make-icecube 2 4) (make-icecube 8 -2))<br />"should be" (make-icecube 10 -8/10)<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM6"><font color="red">Problem 6 (Solution): </font></a><blockquote><pre>; Symbol -&gt; true<br />(define (draw-random-baloon go)<br />  (draw-baloon (random WIDTH) (random HEIGHT) (pick-color (random 4))))<br />&nbsp;<br />; Num Num Symbol[color] -&gt; true<br />; to draw a color-ed baloon, centered at (make-posn x y)<br />(define (draw-baloon x y color)<br />  (and (draw-solid-disk (make-posn x y) RADIUS color)<br />       (draw-solid-line (make-posn x (+ RADIUS y)) <br />                        (make-posn x (+ RADIUS y LENGTH)))))<br />&nbsp;<br />; Num -&gt; Symbol<br />; to translate a number in [0,100] to a color <br />(define (pick-color r)<br />  (cond<br />    [(= r 0) 'red]<br />    [(= r 1) 'blue]<br />    [(= r 2) 'green]<br />    [(= r 3) 'yellow]))<br />&nbsp;<br />(define WIDTH 300)<br />(define HEIGHT 300)<br />&nbsp;<br />(define RADIUS 20)<br />(define LENGTH 40)<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(symbol=? (pick-color 0) 'red)<br />(symbol=? (pick-color 1) 'blue)<br />(symbol=? (pick-color 2) 'green)<br />(symbol=? (pick-color 3) 'yellow)<br />&nbsp;<br />;; --- drawing baloons at known places <br />(start WIDTH HEIGHT)<br />&nbsp;<br />(draw-baloon 100 10 'green)<br />(draw-baloon 200 10 'blue)<br />&nbsp;<br />(sleep-for-a-while 2)<br />&nbsp;<br />;; --- ... and at random places<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />(draw-random-baloon 'go)<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM7"><font color="red">Problem 7 (Solution): </font></a><blockquote><pre>; Num Num Num Num -&gt; true<br />; draw four bars corresponding to the heights h1, h2, h3, h4<br />; assume: 0 &lt;= h1, h2, h3, h4 &lt;= HEIGHT - 20<br />(define (draw-bar-chart h1 h2 h3 h4)<br />    (and<br />         (draw-solid-line (make-posn  0 BASE-LINE) (make-posn WIDTH<br />						     BASE-LINE))<br />	    (draw-solid-rect (make-posn X1 (- BASE-LINE h1)) RWIDE h1 'red)<br />	       (draw-solid-rect (make-posn X2 (- BASE-LINE h2)) RWIDE h2<br />		 'blue)<br />	          (draw-solid-rect (make-posn X3 (- BASE-LINE h3)) RWIDE h3<br />		    'green)<br />		     (draw-solid-rect (make-posn X4 (- BASE-LINE h4)) RWIDE<br />		       h4 'yellow)<br />		        ))<br />&nbsp;<br />(define WIDTH 220)<br />(define HEIGHT 120)<br />&nbsp;<br />(define BASE-LINE (- HEIGHT 20))<br />&nbsp;<br />(define RWIDE (* 1/4 (- WIDTH 20)))<br />&nbsp;<br />(define X1 10)<br />(define X2 (+ X1 RWIDE))<br />(define X3 (+ X2 RWIDE))<br />(define X4 (+ X3 RWIDE))<br />&nbsp;<br />#| Drawings ... |#<br />&nbsp;<br />(start WIDTH HEIGHT)<br />&nbsp;<br />(draw-bar-chart 25 85 30 10)<br /></pre></blockquote></p><br /><hr /><table width="90%"><tr><td align="left"><address><a href="mailto:raymond@ccs.neu.edu">Jamie Raymond</a></address></td><td align="right"><address>Matthias Felleisen</address></td></tr><tr><td align="left">&nbsp;</td><td align="right"><p>23 september 2002 </p></td></tr></table></body></html>