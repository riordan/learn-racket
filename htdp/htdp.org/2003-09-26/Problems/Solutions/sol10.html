<html><head><title>HtDP Solution Set</title></head><body bgcolor="white"><br /><table width="100%"><tr><td align="left"><h3>HtDP Solution Set</h3></td><td align="right"><h3>Section 10</h3></td></tr></table><pre><br /></pre><p><hr /><a name="PROBLEM1"><font color="red">Problem 1 (Solution): </font></a><blockquote><pre>#|<br />A Frequency is a Number<br />&nbsp;<br />A List-of-frequency is one of<br /> - empty<br /> - (cons Frequency List-of-frequency)<br />|#<br />&nbsp;<br />;;filter-freq : Frequency Frequency List-of-frequency -&gt; List-of-frequency<br />;; - return list of frequences below threshold<br />(define (filter-freq f-low f-high a-lof)<br />  (cond<br />   [(empty? a-lof) empty]<br />   [(cons? a-lof)<br />    (cond<br />     [(and (&gt;= (first a-lof) f-low) (&lt;= (first a-lof) f-high))<br />      (cons (first a-lof) (filter-freq f-low f-high (rest a-lof)))]<br />     [else <br />      (filter-freq f-low f-high (rest a-lof))])]))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(filter-freq 100 300 empty)<br />"should be" empty<br />(filter-freq 100 300 <br />  (cons 50 (cons 100 (cons 200 (cons 299 (cons 300 (cons 350 empty)))))))<br />"should be" (cons 100 (cons 200 (cons 299 (cons 300 empty))))<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM2"><font color="red">Problem 2 (Solution): </font></a><blockquote><pre>#|<br />A List-of-number-and-symbol is one of<br /> - empty<br /> - (cons Number List-of-number-and-symbol)<br /> - (cons Symbol List-of-number-and-symbol)<br /> |#<br />&nbsp;<br />(define (symbol-count a-lons)<br />  (cond<br />    [(empty? a-lons) 0]<br />    [(number? (first a-lons))<br />     (symbol-count (rest a-lons))]<br />    [(symbol? (first a-lons))<br />     (+ 1 (symbol-count (rest a-lons)))]))<br />&nbsp;<br />(symbol-count empty)<br />"should be" 0<br />(symbol-count (cons 1 empty))<br />"should be" 0<br />(symbol-count (cons 'a empty))<br />"should be" 1<br />(symbol-count (cons 1 (cons 'a (cons 2 (cons 'b (cons 'c empty))))))<br />"should be" 3<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM3"><font color="red">Problem 3 (Solution): </font></a><blockquote><pre>#|<br />A Bid is a structure<br />  (make-bid Number Number Number)<br />|#<br />&nbsp;<br />(define-struct bid (bidder item amount))<br />#|<br />A Non-empty-list-of-bid is one of<br /> - (cons Bid empty)<br /> - (cons Bid Non-empty-list-of-bid)<br />&nbsp;<br />|#<br />&nbsp;<br />;;highest-bid : Number Non-empty-list-of-bid -&gt; Bid<br />(define (highest-bid an-item a-nelob)<br />  (cond<br />   [(empty? (rest a-nelob)) (first a-nelob)]<br />   [(cons? (rest a-nelob))<br />    (cond<br />     [(and (= (bid-item (first a-nelob))<br />              an-item)<br />           (&gt; (bid-amount (first a-nelob))<br />              (bid-amount (highest-bid an-item (rest a-nelob)))))<br />      (first a-nelob)]<br />     [else (highest-bid an-item (rest a-nelob))])]))<br />&nbsp;<br />&nbsp;<br />#| Tests |#<br />(highest-bid 1000 (cons (make-bid 252 1000 12) empty))<br />"should be" (make-bid 252 1000 12)<br />(highest-bid 1000 (cons (make-bid 252 1000 12) <br />			(cons (make-bid 253 1001 14)<br />			      (cons (make-bid 254 1000 16) empty))))<br />"should be" (make-bid 254 1000 16)<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM4"><font color="red">Problem 4 (Solution): </font></a><blockquote><pre>#|<br />A Substance is a Symbol.<br />&nbsp;<br />A Tank is a structure<br />  (make-tank Substance Number)<br />|#<br />&nbsp;<br />(define-struct tank (subst liters))<br />&nbsp;<br />;remove : Substance List-of-tank -&gt; List-of-tank<br />; - produce new list of tanks without any containing given substance<br />(define (remove s a-lots)<br />  (cond<br />    [(empty? a-lots) empty]<br />    [(cons? a-lots)<br />     (cond<br />       [(symbol=? s (tank-subst (first a-lots)))<br />        (remove s (rest a-lots))]<br />       [else (cons (first a-lots)<br />                   (remove s (rest a-lots)))])]))<br />&nbsp;<br />;combine : Substance List-of-tank -&gt; Number<br />; - combine tanks with same substance into new tank<br />(define (combine a-substance a-lots)<br />  (cond<br />    [(empty? a-lots) 0]<br />    [(cons? a-lots)<br />     (cond<br />       [(symbol=? (tank-subst (first a-lots)) a-substance)<br />        (+ (tank-liters (first a-lots))<br />           (combine a-substance (rest a-lots)))]<br />       [else (combine a-substance (rest a-lots))])]))<br />&nbsp;<br />;consolidate : List-of-tank -&gt; List-of-tank<br />; - combine all tanks with same substances into new list of tanks<br />(define (consolidate a-lots)<br />  (cond<br />    [(empty? a-lots) empty]<br />    [else<br />     (cons<br />      (make-tank (tank-subst (first a-lots)) <br />                 (combine (tank-subst (first a-lots)) a-lots))<br />      (consolidate (remove (tank-subst (first a-lots)) (rest a-lots))))]))<br />&nbsp;<br />#| Tests |#<br />(remove 'sugar empty)<br />"should be" empty<br />(remove 'sugar (cons (make-tank 'sugar 1000)<br />                     (cons (make-tank 'tar 2000)<br />                           (cons (make-tank 'sugar 3000)<br />                                 empty))))<br />"should be" (cons (make-tank 'tar 2000) empty)<br />&nbsp;<br />(combine 'sugar empty)<br />"should be" 0<br />(combine 'sugar <br />         (cons (make-tank 'sugar 2000)<br />               (cons (make-tank 'oil 1000)<br />                     (cons (make-tank 'sugar 1000)<br />                           empty))))<br />"should be" 3000<br />&nbsp;<br />(consolidate empty)<br />"should be" empty<br />(consolidate (cons (make-tank 'tar 2000) empty))<br />"should be" (cons (make-tank 'tar 2000) empty)<br />(consolidate (cons (make-tank 'tar 2000)<br />                   (cons (make-tank 'syrup 1000)<br />                         (cons (make-tank 'tar 1000) empty))))<br />"should be" (cons (make-tank 'tar 3000) (cons (make-tank 'syrup 1000) empty))<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM5"><font color="red">Problem 5 (Solution): </font></a><blockquote><pre>#| A list-of-strings is either <br />   - empty <br />   - (cons String list-of-strings)<br />|#   <br />&nbsp;<br />;which-toppings : SB-list -&gt; list-of-string<br />;- compute the list of strings that are associated with true in a-sb-list<br />(define (which-toppings a-sb-list)<br />  (cond<br />    [(empty? a-sb-list) empty]<br />    [else (cond<br />            [(second (first a-sb-list))<br />             (cons (first (first a-sb-list)) (which-toppings (rest a-sb-list)))]<br />            [else (which-toppings (rest a-sb-list))])]))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(which-toppings empty)<br />"should be" empty<br />(which-toppings<br /> (cons (cons "anchovies" (cons false empty))<br />       (cons (cons "cheese" (cons true empty))<br />             empty)))<br />"should be" <br />(cons "cheese" empty)<br /></pre></blockquote></p><br /><hr /><table width="90%"><tr><td align="left"><address><a href="mailto:raymond@ccs.neu.edu">Jamie Raymond</a></address></td><td align="right"><address>Matthias Felleisen</address></td></tr><tr><td align="left">&nbsp;</td><td align="right"><p>23 september 2002 </p></td></tr></table></body></html>