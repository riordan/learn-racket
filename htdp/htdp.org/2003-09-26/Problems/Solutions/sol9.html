<html><head><title>HtDP Solution Set</title></head><body bgcolor="white"><br /><table width="100%"><tr><td align="left"><h3>HtDP Solution Set</h3></td><td align="right"><h3>Section 9</h3></td></tr></table><pre><br />#| <br />Data Definitions<br /><br />A List-of-number is one of<br /> - empty<br /> - (cons Number List-of-number)<br /><br />A List-of-boolean is one of<br /> - empty<br /> - (cons Boolean List-of-boolean)<br /><br />A Non-empty-list-of-string is one of<br /> - (cons String empty)<br /> - (cons String Non-empty-list-of-string)<br /><br />A List-of-string is one of<br /> - empty<br /> - (cons String List-of-string)<br /><br />A List-of-Symbol is one of<br /> - empty<br /> - (cons Symbol List-of-Symbol)<br />|#<br /><br /><br /></pre><p><hr /><a name="PROBLEM1"><font color="red">Problem 1 (Solution): </font></a><blockquote><pre>;;between? : Number Number Number -&gt; Boolean<br />;  -- is the third number between the first two?<br />(define (between? b e n)<br />  (and (&gt; n b) (&lt; n e)))<br />&nbsp;<br />;; A Three-numbers is (cons Number (cons Number (cons Number empty)))<br />&nbsp;<br />;;three-between? : Number Number Three-numbers -&gt; Boolean<br />; -- are all three numbers in the list between the first two?<br />(define (three-between? b e l)<br />  (and (between? b e (first l))<br />       (between? b e (first (rest l)))<br />       (between? b e (first (rest (rest l))))))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(between? 0 10 2)<br />"should be" true<br />(between? 0 10 0)<br />"should be" false<br />&nbsp;<br />(three-between? 0 10 (cons 1 (cons 2 (cons 3 empty))))<br />"should be" true<br />(three-between? 0 10 (cons 1 (cons 10 (cons 3 empty))))<br />"should be" false<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM2"><font color="red">Problem 2 (Solution): </font></a><blockquote><pre>;;or-list : List-of-boolean -&gt; boolean<br />;;  return or of list<br />(define (or-list a-lob)<br />  (cond<br />   [(empty? a-lob) false]<br />   [else (or (first a-lob) (or-list (rest a-lob)))]))<br />&nbsp;<br />&nbsp;<br />#| Tests |#<br />(or-list empty)<br />"should be" false<br />(or-list (cons true (cons false empty)))<br />"should be" true<br />(or-list (cons false (cons false empty)))<br />"should be" false<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM3"><font color="red">Problem 3 (Solution): </font></a><blockquote><pre>;f : List-of-number -&gt; Number<br />;  -- return the difference of the number of pos and neg numbers in the list<br />(define (f a-lon)<br />  (cond<br />   [(empty? a-lon) 0]<br />   [(cons? a-lon)<br />    (cond<br />     [(&gt; (first a-lon) 0) (+ 1 (f (rest a-lon)))]<br />     [(&lt; (first a-lon) 0) (- (f (rest a-lon)) 1)]<br />     [else (f (rest a-lon))])]))<br />&nbsp;<br />#| Tests |#<br />&nbsp;<br />(f empty)<br />"should be" 0<br />(f (cons 1 empty))<br />"should be" 1<br />(f (cons -1 (cons 1 (cons -2 empty))))<br />"should be" -1<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM4"><font color="red">Problem 4 (Solution): </font></a><blockquote><pre>;;string-append-n* : Non-empty-list-of-string -&gt; String ;; -- append the<br />strings in the non-empty list together (define (string-append-n* a-nelostr)<br />  (cond<br />   [(empty? (rest a-nelostr)) (first a-nelostr)]<br />   [(cons? (rest a-nelostr))<br />    (string-append (first a-nelostr) (string-append-n* (rest a-nelostr)))]))<br />&nbsp;<br />;;string-append* : List-of-string -&gt; String<br />;; - append the strings in the list together<br />(define (string-append* lostr)<br />  (cond<br />   [(empty? lostr) ""]<br />   [(cons? lostr)<br />    (string-append (first lostr) (string-append* (rest lostr)))]))<br />&nbsp;<br />(string-append-n* (cons "test" empty))<br />"should be" "test"<br />(string-append-n* (cons "test" (cons "ing" empty)))<br />"should be" "testing"<br />&nbsp;<br />(string-append* empty)<br />"should be" ""<br />(string-append* (cons "test" empty))<br />"should be" "test"<br />(string-append* (cons "test" (cons "ing" empty)))<br />"should be" "testing"<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><p><hr /><a name="PROBLEM5"><font color="red">Problem 5 (Solution): </font></a><blockquote><pre>;;how-many-symbols: Symbol List-of-symbol -&gt; Number<br />;;  return the number of the times that s appears in the list<br />(define (how-many-symbols s a-los)<br />  (cond<br />   [(empty? a-los) 0]<br />   [(cons? a-los)<br />    (cond<br />     [(symbol=? (first a-los) s)<br />      (+ 1 (how-many-symbols s (rest a-los)))]<br />     [else (how-many-symbols s (rest a-los))])]))<br />&nbsp;<br />;;order: Symbol Number List-of-symbol -&gt; Number<br />;;  return the number of a particular toy that need to be ordered<br />(define (order s n a-los)<br />  (cond<br />   [(&lt;= n (how-many-symbols s a-los)) 0]<br />   [else (- n (how-many-symbols s a-los))]))<br />&nbsp;<br />(how-many-symbols 'doll empty)<br />"should be" 0<br />(how-many-symbols 'doll (cons 'doll (cons 'robot (cons 'doll empty))))<br />"should be" 2<br />(how-many-symbols 'doll (cons 'robot (cons 'house empty)))<br />"should be" 0<br />&nbsp;<br />(order 'doll 10 empty)<br />"should be" 10<br />(order 'doll 3 (cons 'doll (cons 'robot (cons 'doll empty))))<br />"should be" 1<br />(order 'doll 3 (cons 'robot (cons 'house empty)))<br />"should be" 3<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></pre></blockquote></p><br /><hr /><table width="90%"><tr><td align="left"><address><a href="mailto:raymond@ccs.neu.edu">Jamie Raymond</a></address></td><td align="right"><address>Matthias Felleisen</address></td></tr><tr><td align="left">&nbsp;</td><td align="right"><p>23 september 2002 </p></td></tr></table></body></html>